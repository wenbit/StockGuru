# ğŸ“Š Aè‚¡æ•°é‡åŠ¨æ€å˜åŒ–è¯´æ˜

## æ ¸å¿ƒç»“è®º

**5377ä¸æ˜¯å›ºå®šå€¼**ï¼Œä¼šéšå¸‚åœºå˜åŒ–è€ŒåŠ¨æ€æ›´æ–°ï¼

---

## å˜åŒ–å› ç´ 

### å¢åŠ å› ç´  â¬†ï¸

1. **æ–°è‚¡ä¸Šå¸‚ï¼ˆIPOï¼‰**
   - é¢‘ç‡: æ¯å‘¨1-5åª
   - æ¿å—: ä¸»æ¿ã€ç§‘åˆ›æ¿ã€åˆ›ä¸šæ¿
   - ç¤ºä¾‹: 2025å¹´å¹³å‡æ¯æœˆæ–°å¢20-30åª

2. **å€Ÿå£³ä¸Šå¸‚**
   - é¢‘ç‡: è¾ƒå°‘ï¼Œæ¯æœˆ0-2åª
   - æ–¹å¼: é‡ç»„ã€èµ„äº§æ³¨å…¥

### å‡å°‘å› ç´  â¬‡ï¸

1. **é€€å¸‚**
   - STè‚¡è¿ç»­äºæŸ
   - è´¢åŠ¡é€ å‡
   - äº¤æ˜“é‡ä¸è¾¾æ ‡
   - é¢‘ç‡: æ¯å¹´50-100åª

2. **æš‚åœä¸Šå¸‚**
   - ä¸´æ—¶æ€§æªæ–½
   - å¯èƒ½æ¢å¤

---

## å†å²å¢é•¿è¶‹åŠ¿

| å¹´ä»½ | Aè‚¡æ•°é‡ | å¹´å¢é•¿ | å¢é•¿ç‡ |
|------|---------|--------|--------|
| 2020 | ~3800åª | - | - |
| 2021 | ~4200åª | +400 | +10.5% |
| 2022 | ~4600åª | +400 | +9.5% |
| 2023 | ~5000åª | +400 | +8.7% |
| 2024 | ~5200åª | +200 | +4.0% |
| **2025** | **~5377åª** | **+177** | **+3.4%** |

**è¶‹åŠ¿**: æŒç»­å¢é•¿ï¼Œä½†å¢é€Ÿæ”¾ç¼“

---

## å®æ—¶å˜åŒ–ç¤ºä¾‹

### 2025å¹´10æœˆå®é™…å˜åŒ–

```
10æœˆ1æ—¥:  5370åª
10æœˆ8æ—¥:  5373åª (+3, æ–°è‚¡ä¸Šå¸‚)
10æœˆ15æ—¥: 5375åª (+2, æ–°è‚¡ä¸Šå¸‚)
10æœˆ16æ—¥: 5377åª (+2, æ–°è‚¡ä¸Šå¸‚)
10æœˆ22æ—¥: 5379åª (+2, é¢„è®¡)
```

### å…¸å‹ä¸€å‘¨å˜åŒ–

```
å‘¨ä¸€: 5377åª (åŸºå‡†)
å‘¨äºŒ: 5378åª (+1, æ–°è‚¡ä¸Šå¸‚)
å‘¨ä¸‰: 5378åª (æ— å˜åŒ–)
å‘¨å››: 5380åª (+2, æ–°è‚¡ä¸Šå¸‚)
å‘¨äº”: 5379åª (-1, é€€å¸‚)
```

---

## å¦‚ä½•ä¿æŒåŒæ­¥

### æ–¹æ¡ˆ1: åŠ¨æ€è·å–ï¼ˆæ¨èï¼‰âœ…

```python
from datetime import date
import baostock as bs

def get_latest_stock_count():
    """è·å–æœ€æ–°Aè‚¡æ•°é‡"""
    bs.login()
    today = date.today().strftime('%Y-%m-%d')
    rs = bs.query_all_stock(day=today)
    
    count = 0
    while (rs.error_code == '0') & rs.next():
        row = rs.get_row_data()
        code = row[0].split('.')[1]
        if is_a_stock(code):  # è¿‡æ»¤Aè‚¡
            count += 1
    
    bs.logout()
    return count
```

**ä¼˜ç‚¹**:
- âœ… å§‹ç»ˆæ˜¯æœ€æ–°çš„
- âœ… è‡ªåŠ¨åŒ…å«æ–°è‚¡
- âœ… è‡ªåŠ¨æ’é™¤é€€å¸‚è‚¡
- âœ… æ— éœ€ç»´æŠ¤

**ç¼ºç‚¹**:
- âš ï¸ æ¯æ¬¡éœ€è¦1-2ç§’

### æ–¹æ¡ˆ2: ç¼“å­˜ + å®šæœŸæ›´æ–°

```python
import json
from datetime import date
from pathlib import Path

def get_stock_list_cached():
    """è·å–è‚¡ç¥¨åˆ—è¡¨ï¼ˆå¸¦ç¼“å­˜ï¼‰"""
    cache_file = Path(f"cache/stocks_{date.today()}.json")
    
    # æ£€æŸ¥ä»Šæ—¥ç¼“å­˜
    if cache_file.exists():
        with open(cache_file) as f:
            return json.load(f)
    
    # è·å–æœ€æ–°åˆ—è¡¨
    stocks = get_all_stocks()
    
    # ä¿å­˜ç¼“å­˜
    cache_file.parent.mkdir(exist_ok=True)
    with open(cache_file, 'w') as f:
        json.dump(stocks, f)
    
    return stocks
```

**ä¼˜ç‚¹**:
- âœ… å¿«é€Ÿï¼ˆç¼“å­˜å‘½ä¸­ï¼‰
- âœ… å‡å°‘APIè°ƒç”¨
- âœ… æ¯å¤©è‡ªåŠ¨æ›´æ–°

**ç¼ºç‚¹**:
- âš ï¸ éœ€è¦ç®¡ç†ç¼“å­˜æ–‡ä»¶

### æ–¹æ¡ˆ3: æ•°æ®åº“å®šæœŸåŒæ­¥

```python
# æ¯å¤©å‡Œæ™¨2ç‚¹è‡ªåŠ¨åŒæ­¥
# crontab: 0 2 * * * python sync_stock_list.py

def sync_stock_list_to_db():
    """åŒæ­¥è‚¡ç¥¨åˆ—è¡¨åˆ°æ•°æ®åº“"""
    stocks = get_all_stocks()
    
    # æ›´æ–°æ•°æ®åº“
    with db.cursor() as cur:
        cur.execute("TRUNCATE TABLE stock_list")
        cur.execute("""
            INSERT INTO stock_list (code, name, market)
            VALUES %s
        """, stocks)
    
    print(f"åŒæ­¥å®Œæˆ: {len(stocks)} åªè‚¡ç¥¨")
```

---

## å½“å‰å®ç°

### test_copy_sync.py

**ä¹‹å‰ï¼ˆé”™è¯¯ï¼‰**:
```python
# âŒ å›ºå®šæ—¥æœŸï¼Œæ°¸è¿œæ˜¯5377åª
rs = bs.query_all_stock(day='2025-10-16')
```

**ç°åœ¨ï¼ˆæ­£ç¡®ï¼‰**:
```python
# âœ… åŠ¨æ€è·å–ï¼Œè‡ªåŠ¨æ›´æ–°
from datetime import date
today = date.today().strftime('%Y-%m-%d')
rs = bs.query_all_stock(day=today)
logger.info(f"æŸ¥è¯¢æ—¥æœŸ: {today}")
```

### init_historical_data.py

```python
# âœ… å·²ç»æ˜¯åŠ¨æ€çš„
rs = bs.query_all_stock(day=date.today().strftime('%Y-%m-%d'))
```

---

## ç›‘æ§å»ºè®®

### 1. æ¯æ—¥ç»Ÿè®¡

```python
def daily_stock_count_report():
    """æ¯æ—¥è‚¡ç¥¨æ•°é‡æŠ¥å‘Š"""
    today_count = get_stock_count()
    yesterday_count = get_yesterday_count()
    
    change = today_count - yesterday_count
    
    print(f"ğŸ“Š Aè‚¡æ•°é‡æŠ¥å‘Š")
    print(f"ä»Šæ—¥: {today_count} åª")
    print(f"æ˜¨æ—¥: {yesterday_count} åª")
    print(f"å˜åŒ–: {change:+d} åª")
    
    if change > 0:
        print(f"âœ… æ–°å¢ {change} åªè‚¡ç¥¨")
    elif change < 0:
        print(f"âŒ å‡å°‘ {-change} åªè‚¡ç¥¨")
    else:
        print(f"â¡ï¸ æ— å˜åŒ–")
```

### 2. å¼‚å¸¸å‘Šè­¦

```python
def check_abnormal_change():
    """æ£€æŸ¥å¼‚å¸¸å˜åŒ–"""
    change = get_daily_change()
    
    if abs(change) > 10:
        alert(f"âš ï¸ å¼‚å¸¸: å•æ—¥å˜åŒ– {change} åªè‚¡ç¥¨")
    
    if change < -5:
        alert(f"âš ï¸ å¤§é‡é€€å¸‚: {-change} åª")
```

---

## å®é™…å½±å“

### å¯¹æ•°æ®åŒæ­¥çš„å½±å“

**æ¯æ—¥å¢é‡åŒæ­¥**:
```python
# è‡ªåŠ¨é€‚åº”è‚¡ç¥¨æ•°é‡å˜åŒ–
stocks = get_all_stocks()  # åŠ¨æ€è·å–
for stock in stocks:
    sync_stock_data(stock, today)
```

**å†å²æ•°æ®åŒæ­¥**:
```python
# ä½¿ç”¨å†å²æ—¥æœŸçš„è‚¡ç¥¨åˆ—è¡¨
for date in date_range:
    stocks = get_all_stocks(date)  # è¯¥æ—¥æœŸçš„è‚¡ç¥¨åˆ—è¡¨
    sync_stock_data(stocks, date)
```

### å¯¹ç­›é€‰çš„å½±å“

**æ— å½±å“**:
- ç­›é€‰é€»è¾‘åŸºäº**å½“æ—¥æœ‰äº¤æ˜“çš„è‚¡ç¥¨**
- æ–°è‚¡è‡ªåŠ¨åŒ…å«ï¼ˆå¦‚æœæœ‰äº¤æ˜“ï¼‰
- é€€å¸‚è‚¡è‡ªåŠ¨æ’é™¤

---

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆä»Šå¤©è·å–çš„æ•°é‡å’Œæ˜¨å¤©ä¸ä¸€æ ·ï¼Ÿ

**A**: æ­£å¸¸ç°è±¡ï¼å¯èƒ½åŸå› ï¼š
1. æ–°è‚¡ä¸Šå¸‚
2. è‚¡ç¥¨é€€å¸‚
3. å‘¨æœ«/èŠ‚å‡æ—¥ï¼ˆä½¿ç”¨æœ€è¿‘äº¤æ˜“æ—¥æ•°æ®ï¼‰

### Q2: å¦‚ä½•è·å–å†å²æŸå¤©çš„è‚¡ç¥¨æ•°é‡ï¼Ÿ

```python
# è·å–2024-01-01çš„è‚¡ç¥¨åˆ—è¡¨
rs = bs.query_all_stock(day='2024-01-01')
```

### Q3: éäº¤æ˜“æ—¥ä¼šæ€æ ·ï¼Ÿ

```python
# éäº¤æ˜“æ—¥ä¼šè¿”å›æœ€è¿‘äº¤æ˜“æ—¥çš„æ•°æ®
# ä¾‹å¦‚: å‘¨å…­æŸ¥è¯¢ â†’ è¿”å›å‘¨äº”çš„æ•°æ®
rs = bs.query_all_stock(day='2025-10-18')  # å‘¨å…­
# å®é™…è¿”å›: 2025-10-17 (å‘¨äº”) çš„æ•°æ®
```

---

## æ€»ç»“

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **æ˜¯å¦å›ºå®š** | âŒ ä¸å›ºå®šï¼ŒåŠ¨æ€å˜åŒ– |
| **å˜åŒ–é¢‘ç‡** | æ¯å‘¨ 5-20åª |
| **å¹´å¢é•¿** | 200-400åª |
| **æ¨èæ–¹æ¡ˆ** | åŠ¨æ€è·å–ï¼ˆæ¯æ¬¡æŸ¥è¯¢ï¼‰ |
| **ç¼“å­˜ç­–ç•¥** | æŒ‰æ—¥æœŸç¼“å­˜ |
| **ç›‘æ§** | æ¯æ—¥ç»Ÿè®¡ + å¼‚å¸¸å‘Šè­¦ |

**æœ€ä½³å®è·µ**: 
- âœ… ä½¿ç”¨åŠ¨æ€è·å–
- âœ… æŒ‰æ—¥æœŸç¼“å­˜
- âœ… è®°å½•æ¯æ—¥å˜åŒ–
- âœ… å¼‚å¸¸å‘Šè­¦

---

**æ›´æ–°æ—¶é—´**: 2025-10-17  
**å½“å‰æ•°é‡**: 5377åª  
**ä¸‹æ¬¡æ›´æ–°**: è‡ªåŠ¨ï¼ˆæ¯æ¬¡è¿è¡Œæ—¶ï¼‰
