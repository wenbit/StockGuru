# Excel å¯¼å‡ºåŠŸèƒ½å®žçŽ°æŠ¥å‘Š

**å®žçŽ°æ—¶é—´**: 2025-10-15 03:57  
**åŠŸèƒ½**: å¯¼å‡ºç­›é€‰æŠ¥å‘Šä¸º Excel æ–‡ä»¶

---

## âœ¨ åŠŸèƒ½æ¦‚è¿°

å®žçŽ°äº†ä¸“ä¸šçš„ Excel æ ¼å¼æŠ¥å‘Šå¯¼å‡ºåŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥ä¸‹è½½ `.xlsx` æ–‡ä»¶è¿›è¡Œæ•°æ®åˆ†æžå’Œå¤„ç†ã€‚

### åŠŸèƒ½ç‰¹ç‚¹
- ðŸ“Š **Excel æ ¼å¼**: æ ‡å‡†çš„ .xlsx æ–‡ä»¶ï¼Œå…¼å®¹æ‰€æœ‰ Office è½¯ä»¶
- ðŸŽ¨ **ä¸“ä¸šæ ·å¼**: ç²¾ç¾Žçš„è¡¨æ ¼æ ·å¼å’Œé¢œè‰²æ ‡è¯†
- ðŸ“ˆ **æ•°æ®å®Œæ•´**: åŒ…å«æ‰€æœ‰ç­›é€‰ç»“æžœå’Œå…³é”®æŒ‡æ ‡
- ðŸ”¢ **ä¾¿äºŽåˆ†æž**: å¯ç›´æŽ¥åœ¨ Excel ä¸­è¿›è¡Œæ•°æ®åˆ†æžå’Œå›¾è¡¨åˆ¶ä½œ
- ðŸ’¾ **è‡ªåŠ¨ä¸‹è½½**: ç‚¹å‡»æŒ‰é’®è‡ªåŠ¨ä¸‹è½½æ–‡ä»¶

---

## ðŸ› ï¸ æŠ€æœ¯å®žçŽ°

### 1. åŽç«¯å®žçŽ°

#### ä½¿ç”¨åº“
- **openpyxl**: Python çš„ Excel æ–‡ä»¶æ“ä½œåº“
- å·²å®‰è£…ï¼Œæ— éœ€é¢å¤–ç³»ç»Ÿä¾èµ–

#### API ç«¯ç‚¹
**ç«¯ç‚¹**: `GET /api/v1/screening/{task_id}/export/excel`

**åŠŸèƒ½**: ç”Ÿæˆå¹¶è¿”å›ž Excel æ–‡ä»¶

**æµç¨‹**:
```python
1. èŽ·å–ä»»åŠ¡ç»“æžœ
2. åˆ›å»º Excel å·¥ä½œç°¿
3. è®¾ç½®æ ·å¼ï¼ˆå­—ä½“ã€é¢œè‰²ã€è¾¹æ¡†ï¼‰
4. æ·»åŠ æ ‡é¢˜å’Œè¡¨å¤´
5. å¡«å……æ•°æ®
6. åº”ç”¨æ¡ä»¶æ ¼å¼ï¼ˆæ¶¨è·Œå¹…é¢œè‰²ï¼‰
7. è¿”å›žæ–‡ä»¶æµ
```

### 2. Excel æ ·å¼è®¾è®¡

#### æ ‡é¢˜è¡Œ
- èƒŒæ™¯è‰²: è“è‰² (#2563EB)
- å­—ä½“: å¾®è½¯é›…é»‘ 16å· ç²—ä½“ ç™½è‰²
- åˆå¹¶å•å…ƒæ ¼: A1:H1
- å†…å®¹: "ðŸ“ˆ StockGuru è‚¡ç¥¨ç­›é€‰æŠ¥å‘Š"

#### ä¿¡æ¯è¡Œ
- åˆå¹¶å•å…ƒæ ¼: A2:H2
- å†…å®¹: ç”Ÿæˆæ—¶é—´å’Œç­›é€‰ç»“æžœæ•°é‡
- å±…ä¸­å¯¹é½

#### è¡¨å¤´
- èƒŒæ™¯è‰²: ç°è‰² (#E5E7EB)
- å­—ä½“: å¾®è½¯é›…é»‘ 11å· ç²—ä½“
- å±…ä¸­å¯¹é½
- è¾¹æ¡†: å…¨è¾¹æ¡†

#### æ•°æ®è¡Œ
- å­—ä½“: é»˜è®¤
- å±…ä¸­å¯¹é½
- è¾¹æ¡†: å…¨è¾¹æ¡†
- **æ¶¨è·Œå¹…é¢œè‰²**:
  - ä¸Šæ¶¨: çº¢è‰² (#FF0000) ç²—ä½“
  - ä¸‹è·Œ: ç»¿è‰² (#00B050) ç²—ä½“

### 3. åˆ—å®½è®¾ç½®

| åˆ— | å®½åº¦ | è¯´æ˜Ž |
|----|------|------|
| A (æŽ’å) | 8 | æ•°å­— |
| B (è‚¡ç¥¨ä»£ç ) | 12 | 6ä½ä»£ç  |
| C (è‚¡ç¥¨åç§°) | 15 | ä¸­æ–‡åç§° |
| D (åŠ¨é‡åˆ†æ•°) | 12 | å°æ•° |
| E (ç»¼åˆè¯„åˆ†) | 12 | å°æ•° |
| F (æœ€æ–°ä»·) | 10 | ä»·æ ¼ |
| G (æ¶¨è·Œå¹…) | 10 | ç™¾åˆ†æ¯” |
| H (æˆäº¤é‡) | 15 | å¤§æ•°å­— |

---

## ðŸ“ Excel æ–‡ä»¶ç»“æž„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ“ˆ StockGuru è‚¡ç¥¨ç­›é€‰æŠ¥å‘Š                               â”‚  (è“è‰²èƒŒæ™¯)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç”Ÿæˆæ—¶é—´: 2025-10-15 03:57:00  |  ç­›é€‰ç»“æžœ: å…± 10 åªè‚¡ç¥¨ â”‚
â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚æŽ’åâ”‚è‚¡ç¥¨ä»£ç  â”‚è‚¡ç¥¨åç§°  â”‚åŠ¨é‡åˆ†æ•°  â”‚ç»¼åˆè¯„åˆ†  â”‚æœ€æ–°ä»·  â”‚... (ç°è‰²èƒŒæ™¯)
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ 601212  â”‚ ç™½é“¶æœ‰è‰² â”‚  85.23   â”‚  0.8765  â”‚  5.53  â”‚...
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2  â”‚ 000001  â”‚ å¹³å®‰é“¶è¡Œ â”‚  78.45   â”‚  0.8234  â”‚ 12.34  â”‚...
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ...â”‚   ...   â”‚   ...    â”‚   ...    â”‚   ...    â”‚  ...   â”‚...
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸ å…è´£å£°æ˜Ž: æœ¬æŠ¥å‘Šä»…ä¾›å‚è€ƒï¼Œä¸æž„æˆä»»ä½•æŠ•èµ„å»ºè®®ã€‚å¸‚åœºæœ‰é£Žé™©ï¼ŒæŠ•èµ„éœ€è°¨æ…Žã€‚
```

---

## ðŸŽ¯ ä½¿ç”¨æ–¹æ³•

### 1. å®Œæˆç­›é€‰ä»»åŠ¡
åœ¨é¦–é¡µè¿›è¡Œè‚¡ç¥¨ç­›é€‰ï¼Œç­‰å¾…ä»»åŠ¡å®Œæˆï¼ˆè¿›åº¦ 100%ï¼‰

### 2. å¯¼å‡º Excel
åœ¨ç­›é€‰ç»“æžœåŒºåŸŸï¼Œç‚¹å‡»"ðŸ“Š ExcelæŠ¥å‘Š"æŒ‰é’®

### 3. ä¸‹è½½æ–‡ä»¶
æµè§ˆå™¨ä¼šè‡ªåŠ¨ä¸‹è½½ Excel æ–‡ä»¶ï¼š
```
stockguru_report_20251015_035700.xlsx
```

### 4. æ‰“å¼€æ–‡ä»¶
ä½¿ç”¨ä»¥ä¸‹ä»»ä¸€è½¯ä»¶æ‰“å¼€ï¼š
- Microsoft Excel
- WPS Office
- LibreOffice Calc
- Google Sheets
- Apple Numbers

---

## ðŸ“Š æ•°æ®åˆ—è¯´æ˜Ž

| åˆ—å | æ•°æ®ç±»åž‹ | è¯´æ˜Ž | ç¤ºä¾‹ |
|------|---------|------|------|
| æŽ’å | æ•´æ•° | æœ€ç»ˆæŽ’å | 1, 2, 3... |
| è‚¡ç¥¨ä»£ç  | æ–‡æœ¬ | 6ä½æ•°å­—ä»£ç  | 601212 |
| è‚¡ç¥¨åç§° | æ–‡æœ¬ | ä¸­æ–‡åç§° | ç™½é“¶æœ‰è‰² |
| åŠ¨é‡åˆ†æ•° | å°æ•° | åŠ¨é‡å¾—åˆ† (2ä½å°æ•°) | 85.23 |
| ç»¼åˆè¯„åˆ† | å°æ•° | ç»¼åˆè¯„åˆ† (4ä½å°æ•°) | 0.8765 |
| æœ€æ–°ä»· | å°æ•° | æ”¶ç›˜ä»· (2ä½å°æ•°) | 5.53 |
| æ¶¨è·Œå¹… | å°æ•° | æ¶¨è·Œç™¾åˆ†æ¯” (2ä½å°æ•°) | +4.39 |
| æˆäº¤é‡ | æ•´æ•° | æˆäº¤é‡ | 12345678 |

---

## ðŸ’¡ Excel ä½¿ç”¨æŠ€å·§

### 1. æ•°æ®æŽ’åº
- é€‰ä¸­æ•°æ®åŒºåŸŸ
- ç‚¹å‡»"æ•°æ®" â†’ "æŽ’åº"
- é€‰æ‹©æŽ’åºåˆ—ï¼ˆå¦‚æŒ‰åŠ¨é‡åˆ†æ•°é™åºï¼‰

### 2. æ•°æ®ç­›é€‰
- é€‰ä¸­è¡¨å¤´è¡Œ
- ç‚¹å‡»"æ•°æ®" â†’ "ç­›é€‰"
- ä½¿ç”¨ä¸‹æ‹‰ç®­å¤´ç­›é€‰æ•°æ®

### 3. åˆ›å»ºå›¾è¡¨
- é€‰ä¸­æ•°æ®
- ç‚¹å‡»"æ’å…¥" â†’ "å›¾è¡¨"
- é€‰æ‹©å›¾è¡¨ç±»åž‹ï¼ˆæŸ±çŠ¶å›¾ã€æŠ˜çº¿å›¾ç­‰ï¼‰

### 4. æ¡ä»¶æ ¼å¼
- é€‰ä¸­æ•°æ®åˆ—
- ç‚¹å‡»"å¼€å§‹" â†’ "æ¡ä»¶æ ¼å¼"
- è®¾ç½®è§„åˆ™ï¼ˆå¦‚é«˜äº®æ˜¾ç¤ºå‰3åï¼‰

### 5. æ•°æ®é€è§†è¡¨
- é€‰ä¸­æ‰€æœ‰æ•°æ®
- ç‚¹å‡»"æ’å…¥" â†’ "æ•°æ®é€è§†è¡¨"
- è¿›è¡Œå¤šç»´åº¦åˆ†æž

---

## ðŸŽ¨ æ ·å¼ç‰¹ç‚¹

### 1. é¢œè‰²æ–¹æ¡ˆ
- **æ ‡é¢˜**: è“è‰²ä¸»é¢˜ (#2563EB)
- **è¡¨å¤´**: æµ…ç°è‰² (#E5E7EB)
- **ä¸Šæ¶¨**: çº¢è‰² (#FF0000)
- **ä¸‹è·Œ**: ç»¿è‰² (#00B050)

### 2. å­—ä½“
- **ä¸­æ–‡**: å¾®è½¯é›…é»‘
- **æ•°å­—**: é»˜è®¤ï¼ˆCalibriï¼‰
- **æ ‡é¢˜**: 16å·ç²—ä½“
- **è¡¨å¤´**: 11å·ç²—ä½“
- **æ•°æ®**: 11å·å¸¸è§„

### 3. å¯¹é½æ–¹å¼
- **æ ‡é¢˜**: å±…ä¸­
- **è¡¨å¤´**: å±…ä¸­
- **æ•°æ®**: å±…ä¸­
- **å…è´£å£°æ˜Ž**: å±…ä¸­

---

## ðŸ”§ æŠ€æœ¯ç»†èŠ‚

### openpyxl æ ¸å¿ƒä»£ç 

```python
from openpyxl import Workbook
from openpyxl.styles import Font, Alignment, PatternFill, Border, Side

# åˆ›å»ºå·¥ä½œç°¿
wb = Workbook()
ws = wb.active

# è®¾ç½®æ ·å¼
title_font = Font(name='å¾®è½¯é›…é»‘', size=16, bold=True, color='FFFFFF')
title_fill = PatternFill(start_color='2563EB', end_color='2563EB', fill_type='solid')

# æ·»åŠ æ•°æ®
ws['A1'] = 'æ ‡é¢˜'
ws['A1'].font = title_font
ws['A1'].fill = title_fill

# ä¿å­˜åˆ°å†…å­˜
excel_buffer = io.BytesIO()
wb.save(excel_buffer)
excel_buffer.seek(0)

# è¿”å›žæ–‡ä»¶
return Response(
    content=excel_buffer.getvalue(),
    media_type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
    headers={"Content-Disposition": f"attachment; filename={filename}"}
)
```

### æ¡ä»¶æ ¼å¼å®žçŽ°

```python
# æ¶¨è·Œå¹…é¢œè‰²
if col == 7:  # æ¶¨è·Œå¹…åˆ—
    change_pct = stock.get('change_pct', 0)
    if change_pct > 0:
        cell.font = Font(color='FF0000', bold=True)  # çº¢è‰²
    elif change_pct < 0:
        cell.font = Font(color='00B050', bold=True)  # ç»¿è‰²
```

---

## ðŸ“ ä¿®æ”¹æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ | çŠ¶æ€ |
|------|---------|------|
| `stockguru-web/backend/app/api/screening.py` | æ·»åŠ  Excel å¯¼å‡º API | âœ… å·²å®žçŽ° |
| `frontend/app/page.tsx` | æ›´æ–°å¯¼å‡ºæŒ‰é’® | âœ… å·²å®žçŽ° |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ–‡ä»¶å¤§å°
- 10åªè‚¡ç¥¨: ~10 KB
- 30åªè‚¡ç¥¨: ~15 KB
- 100åªè‚¡ç¥¨: ~30 KB

### 2. å…¼å®¹æ€§
- âœ… Excel 2007 åŠä»¥ä¸Šç‰ˆæœ¬
- âœ… WPS Office
- âœ… LibreOffice 4.0+
- âœ… Google Sheets (ä¸Šä¼ åŽ)
- âš ï¸ Excel 2003 (éœ€è¦è½¬æ¢)

### 3. ä¸­æ–‡å­—ä½“
- Windows: å¾®è½¯é›…é»‘è‡ªåŠ¨å¯ç”¨
- macOS: éœ€è¦å®‰è£…å¾®è½¯é›…é»‘æˆ–ä½¿ç”¨ç³»ç»Ÿå­—ä½“
- Linux: éœ€è¦å®‰è£…ä¸­æ–‡å­—ä½“

---

## ðŸš€ æœªæ¥ä¼˜åŒ–

### 1. å¤šå·¥ä½œè¡¨
```python
# æ·»åŠ ç¬¬äºŒä¸ªå·¥ä½œè¡¨ï¼šè¯¦ç»†æ•°æ®
ws2 = wb.create_sheet("è¯¦ç»†æ•°æ®")
# æ·»åŠ Kçº¿æ•°æ®ã€æŠ€æœ¯æŒ‡æ ‡ç­‰
```

### 2. å›¾è¡¨åµŒå…¥
```python
from openpyxl.chart import BarChart, Reference

# åˆ›å»ºæŸ±çŠ¶å›¾
chart = BarChart()
data = Reference(ws, min_col=4, min_row=3, max_row=13)
chart.add_data(data, titles_from_data=True)
ws.add_chart(chart, "J5")
```

### 3. æ•°æ®éªŒè¯
```python
from openpyxl.worksheet.datavalidation import DataValidation

# æ·»åŠ ä¸‹æ‹‰åˆ—è¡¨
dv = DataValidation(type="list", formula1='"ä¼˜ç§€,è‰¯å¥½,ä¸€èˆ¬"')
ws.add_data_validation(dv)
```

### 4. å…¬å¼æ”¯æŒ
```python
# æ·»åŠ è®¡ç®—å…¬å¼
ws['I4'] = '=D4*E4'  # åŠ¨é‡åˆ†æ•° Ã— ç»¼åˆè¯„åˆ†
```

---

## ðŸ“Š åŠŸèƒ½å¯¹æ¯”

| ç‰¹æ€§ | HTMLæŠ¥å‘Š | ExcelæŠ¥å‘Š |
|------|----------|----------|
| æŸ¥çœ‹æ–¹å¼ | æµè§ˆå™¨ | Excelè½¯ä»¶ âœ… |
| æ•°æ®åˆ†æž | ä¸æ”¯æŒ | å®Œå…¨æ”¯æŒ âœ… |
| æŽ’åºç­›é€‰ | ä¸æ”¯æŒ | å®Œå…¨æ”¯æŒ âœ… |
| å›¾è¡¨åˆ¶ä½œ | ä¸æ”¯æŒ | å®Œå…¨æ”¯æŒ âœ… |
| æ•°æ®å¯¼å‡º | éœ€å¤åˆ¶ | ç›´æŽ¥ä½¿ç”¨ âœ… |
| æ‰“å°æ•ˆæžœ | ä¸€èˆ¬ | ä¼˜ç§€ âœ… |
| æ–‡ä»¶å¤§å° | å° | å° âœ… |
| ä¸“ä¸šæ€§ | ä¸€èˆ¬ | ä¸“ä¸š âœ… |

---

## âœ… æµ‹è¯•éªŒè¯

### 1. API æµ‹è¯•
```bash
# æµ‹è¯• Excel å¯¼å‡º
curl -O "http://localhost:8000/api/v1/screening/{task_id}/export/excel"

# æ£€æŸ¥æ–‡ä»¶
file stockguru_report_*.xlsx
# è¾“å‡º: Microsoft Excel 2007+
```

### 2. å‰ç«¯æµ‹è¯•
1. å®Œæˆä¸€æ¬¡ç­›é€‰
2. ç‚¹å‡»"ðŸ“Š ExcelæŠ¥å‘Š"æŒ‰é’®
3. éªŒè¯æ–‡ä»¶è‡ªåŠ¨ä¸‹è½½
4. ç”¨ Excel æ‰“å¼€æ£€æŸ¥å†…å®¹å’Œæ ·å¼

### 3. æ•°æ®éªŒè¯
- âœ… æ‰€æœ‰æ•°æ®æ­£ç¡®
- âœ… æ ·å¼å®Œæ•´
- âœ… é¢œè‰²æ­£ç¡®
- âœ… ä¸­æ–‡æ˜¾ç¤ºæ­£å¸¸

---

## ðŸ“š ç›¸å…³èµ„æº

### æ–‡æ¡£
- [openpyxl å®˜æ–¹æ–‡æ¡£](https://openpyxl.readthedocs.io/)
- [Excel æ–‡ä»¶æ ¼å¼è§„èŒƒ](https://docs.microsoft.com/en-us/openspecs/office_standards/)
- [Python Excel æ•™ç¨‹](https://realpython.com/openpyxl-excel-spreadsheets-python/)

### å·¥å…·
- [Excel Viewer](https://www.microsoft.com/en-us/microsoft-365/excel)
- [WPS Office](https://www.wps.com/)
- [LibreOffice](https://www.libreoffice.org/)

---

## ðŸ“ æ€»ç»“

### å·²å®žçŽ°
- âœ… Excel æ–‡ä»¶ç”Ÿæˆ
- âœ… ä¸“ä¸šæ ·å¼è®¾è®¡
- âœ… æ¡ä»¶æ ¼å¼ï¼ˆæ¶¨è·Œå¹…é¢œè‰²ï¼‰
- âœ… è‡ªåŠ¨ä¸‹è½½
- âœ… å®Œæ•´æ•°æ®å¯¼å‡º

### ä¼˜åŠ¿
- ðŸ“Š ä¸“ä¸šçš„æ•°æ®åˆ†æžå·¥å…·
- ðŸŽ¨ ç²¾ç¾Žçš„æ ·å¼è®¾è®¡
- ðŸ”¢ ä¾¿äºŽäºŒæ¬¡å¤„ç†
- ðŸ’¾ æ ‡å‡†æ–‡ä»¶æ ¼å¼
- ðŸš€ é›¶ä¾èµ–ï¼Œçº¯ Python

### ä½¿ç”¨å»ºè®®
- **HTMLæŠ¥å‘Š**: å¿«é€ŸæŸ¥çœ‹å’Œåœ¨çº¿åˆ†äº«
- **ExcelæŠ¥å‘Š**: æ•°æ®åˆ†æžã€å›¾è¡¨åˆ¶ä½œã€æ·±åº¦ç ”ç©¶

---

*æœ€åŽæ›´æ–°: 2025-10-15 03:57*
