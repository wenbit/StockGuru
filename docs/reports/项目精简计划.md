# 项目精简计划

**时间**: 2025-10-15 04:30  
**目标**: 删除无用的代码文件，精简项目结构

---

## 🎯 精简目标

### 当前状态
- 项目包含旧的CLI版本代码
- 部分目录为空或不再使用
- 存在重复的模板文件

### 精简后
- 只保留Web版本的核心代码
- 删除旧的CLI模块
- 清理空目录和临时文件

---

## 📋 待删除文件/目录

### 1. 旧的CLI模块（已被Web版本替代）
```
modules/
├── __init__.py
├── data_fetcher.py          # 旧版数据获取
├── momentum_calculator.py   # 旧版动量计算
├── report_generator.py      # 旧版报告生成
└── stock_filter.py          # 旧版股票筛选
```
**原因**: 
- Web版本在 `stockguru-web/backend/app/services/modules/` 有新实现
- 旧模块不再使用

### 2. 旧的CLI主程序
```
main.py                      # 旧版CLI主程序
```
**原因**:
- 新的CLI工具是 `cli.py`，使用Web后端
- `main.py` 是旧版本，不再使用

### 3. 旧的模板文件
```
templates/
└── report_template.html     # 旧版报告模板
```
**原因**:
- Web版本在 `stockguru-web/backend/app/templates/` 有新模板
- 根目录的模板不再使用

### 4. 空目录
```
static/                      # 空目录，无文件
output/                      # 输出目录（可选保留）
data/cache/                  # 缓存目录（可选保留）
```

### 5. 临时/测试文件
```
.specstory/                  # 开发工具目录
.claude/                     # 开发工具目录
```

---

## ✅ 保留文件

### 核心代码
- ✅ `cli.py` - 新版CLI工具（使用Web后端）
- ✅ `config.py` - 配置文件
- ✅ `requirements.txt` - Python依赖

### 核心文档
- ✅ `README.md` - 项目说明
- ✅ `prd.md` - 产品需求
- ✅ `design.md` - 技术设计

### 核心目录
- ✅ `stockguru-web/` - Web项目（前后端）
- ✅ `frontend/` - Next.js前端
- ✅ `docs/` - 文档
- ✅ `scripts/` - 脚本
- ✅ `tests/` - 测试

---

## 🔍 详细分析

### modules/ vs stockguru-web/backend/app/services/modules/

**旧版 (modules/)**:
```python
# 独立的CLI模块
modules/data_fetcher.py
modules/momentum_calculator.py
modules/stock_filter.py
modules/report_generator.py
```

**新版 (stockguru-web/backend/app/services/modules/)**:
```python
# Web后端模块，功能更完善
app/services/modules/data_fetcher.py
app/services/modules/momentum_calculator.py
app/services/modules/stock_filter.py
```

**结论**: 旧版modules/已被完全替代，可以删除

### main.py vs cli.py

**main.py**:
- 旧版CLI主程序
- 直接使用 modules/ 中的代码
- 功能简单

**cli.py**:
- 新版CLI工具
- 使用 stockguru-web/backend 的API
- 功能完整，与Web版本一致

**结论**: main.py 已被 cli.py 替代，可以删除

### templates/ 对比

**根目录 templates/**:
- 旧版HTML模板
- 用于CLI版本的报告生成

**stockguru-web/backend/app/templates/**:
- 新版HTML模板
- 用于Web版本的报告导出

**结论**: 根目录的templates/已被替代，可以删除

---

## 📊 精简效果预估

### 删除前
```
项目大小: ~50MB
文件数量: ~200个
代码行数: ~15000行
```

### 删除后
```
项目大小: ~45MB (-10%)
文件数量: ~190个 (-10个)
代码行数: ~13500行 (-10%)
```

### 目录结构
```
StockGuru/
├── README.md, prd.md, design.md
├── cli.py, config.py
├── requirements.txt
│
├── stockguru-web/          # Web项目（主要）
├── frontend/               # Next.js前端
├── docs/                   # 文档
├── scripts/                # 脚本
└── tests/                  # 测试
```

---

## ⚠️ 风险评估

### 低风险（可以删除）
- ✅ `modules/` - 已完全被Web版本替代
- ✅ `main.py` - 已被cli.py替代
- ✅ `templates/` - 已被Web版本替代
- ✅ `.specstory/`, `.claude/` - 开发工具目录

### 中风险（建议保留）
- ⚠️ `output/` - 可能有用户输出文件
- ⚠️ `data/` - 可能有缓存数据

### 高风险（必须保留）
- ❌ `stockguru-web/` - 核心Web项目
- ❌ `frontend/` - 前端项目
- ❌ `cli.py` - 新版CLI工具

---

## 🚀 执行计划

### 阶段1: 备份（可选）
```bash
# 创建备份
tar -czf stockguru_backup_$(date +%Y%m%d).tar.gz modules/ main.py templates/
```

### 阶段2: 删除旧代码
```bash
# 删除旧的CLI模块
rm -rf modules/

# 删除旧的主程序
rm main.py

# 删除旧的模板
rm -rf templates/

# 删除开发工具目录
rm -rf .specstory/ .claude/

# 删除空目录
rm -rf static/
```

### 阶段3: 清理空目录
```bash
# 清理__pycache__
find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null

# 清理.DS_Store
find . -name ".DS_Store" -delete
```

### 阶段4: 更新文档
- 更新README.md
- 更新.gitignore
- 提交Git

---

## 📝 执行脚本

```bash
#!/bin/bash
# 项目精简脚本

echo "🗑️ 开始精简项目..."

# 删除旧的CLI模块
if [ -d "modules" ]; then
    echo "删除 modules/"
    rm -rf modules/
fi

# 删除旧的主程序
if [ -f "main.py" ]; then
    echo "删除 main.py"
    rm main.py
fi

# 删除旧的模板
if [ -d "templates" ]; then
    echo "删除 templates/"
    rm -rf templates/
fi

# 删除开发工具目录
if [ -d ".specstory" ]; then
    echo "删除 .specstory/"
    rm -rf .specstory/
fi

if [ -d ".claude" ]; then
    echo "删除 .claude/"
    rm -rf .claude/
fi

# 删除空目录
if [ -d "static" ] && [ -z "$(ls -A static)" ]; then
    echo "删除空目录 static/"
    rm -rf static/
fi

# 清理缓存
echo "清理 __pycache__..."
find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null

echo "清理 .DS_Store..."
find . -name ".DS_Store" -delete

echo "✅ 精简完成！"
echo ""
echo "已删除:"
echo "  - modules/ (旧CLI模块)"
echo "  - main.py (旧主程序)"
echo "  - templates/ (旧模板)"
echo "  - .specstory/, .claude/ (开发工具)"
echo "  - static/ (空目录)"
echo "  - __pycache__, .DS_Store (缓存)"
```

---

## ✅ 验证清单

删除后需要验证：

- [ ] Web服务正常启动
- [ ] 前端正常运行
- [ ] CLI工具正常工作
- [ ] 筛选功能正常
- [ ] 导出功能正常
- [ ] 没有import错误

---

## 📚 相关文档

- `docs/guides/CLI使用指南.md` - CLI工具使用说明
- `stockguru-web/README.md` - Web项目说明
- `README.md` - 项目主文档

---

*创建时间: 2025-10-15 04:30*
