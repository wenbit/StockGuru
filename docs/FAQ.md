# StockGuru 常见问题 (FAQ)

**最后更新**: 2025-10-15

---

## 📋 目录

- [筛选结果相关](#筛选结果相关)
- [数据来源相关](#数据来源相关)
- [功能使用相关](#功能使用相关)

---

## 筛选结果相关

### ❓ 为什么每次筛选同一天的数据，结果都不一样？

**回答**: 这是正常现象，不是bug。

#### 原因分析

**1. 数据源是动态的**

系统使用的是**问文财 (pywencai)** 数据源，它返回的是实时/准实时数据，而不是历史快照。

```python
# 代码位置: stockguru-web/backend/app/services/modules/data_fetcher.py
query = f'{date}成交额前{top_n}'
df = pywencai.get(query=query, loop=True)  # 获取实时数据
```

**2. 排名会变化**

筛选逻辑是取两个列表的交集：
```
成交额Top100 ∩ 热度Top100 = 候选股票池
```

如果两个列表都有变化：
- 成交额排名可能调整（数据修正、大宗交易延迟计入）
- 热度排名更容易变化（基于实时关注度）
- 交集结果就会不同

**3. 边界效应**

排名在98-102之间的股票，数值往往非常接近，轻微的变化就会导致：
- 进入或退出Top100
- 影响最终的筛选结果

#### 具体示例

**第一次筛选** (16:00):
```
成交额Top100: [中芯国际, 白银有色, 上海电气, ...]
热度Top100:   [中芯国际, 白银有色, 上海电气, ...]
交集结果:     中芯国际 排名第1 🥇
```

**第二次筛选** (16:10):
```
成交额Top100: [中芯国际, 白银有色, 上海电气, ...]
热度Top101:   [白银有色, 上海电气, ...] (中芯国际热度降到101名)
交集结果:     白银有色 排名第1 🥇
```

#### 差异程度

- **核心股票稳定**: 前3-5名通常不变
- **边界股票波动**: 第8-10名可能变化
- **差异数量**: 通常只有1-3只股票不同

#### 这是正常的吗？

**✅ 完全正常！** 因为：
- 数据源本身就是动态的
- 反映了市场的实时变化
- 差异通常很小

#### 解决方案

**方案1: 添加缓存（推荐）**

实现简单的缓存机制，同一天的查询使用缓存数据：

```python
class DataFetcher:
    def __init__(self):
        self.cache = {}  # 内存缓存
        
    def get_volume_top_stocks(self, date: str, top_n: int = 100):
        cache_key = f"volume_{date}_{top_n}"
        
        # 检查缓存
        if cache_key in self.cache:
            return self.cache[cache_key]
        
        # 获取数据并缓存
        df = self._fetch_volume_data(date, top_n)
        self.cache[cache_key] = df
        return df
```

**方案2: 数据快照**

每天保存一份数据快照到数据库，用于历史回测。

**方案3: 扩大筛选范围**

获取Top150，然后取前100，减少边界效应。

#### 用户建议

1. **理解这是正常现象**
   - 不是系统bug
   - 反映了市场的动态性
   - 差异通常很小

2. **关注核心股票**
   - 重点看前3-5名
   - 这些股票排名相对稳定
   - 边界股票可以忽略

3. **选择合适的查询时间**
   - 盘后1小时数据较稳定
   - 避免盘中查询
   - 次日查询更准确

4. **多次筛选取交集**
   - 如果需要更稳定的结果
   - 可以多次筛选
   - 取多次结果的交集

#### 技术细节

详细的技术分析请查看：
- `筛选结果差异说明.md` - 完整的技术分析
- `docs/reports/系统架构与功能需求分析报告.md` - 系统架构

---

## 数据来源相关

### ❓ 数据从哪里来？

**回答**: 

系统使用多个数据源，按优先级降级：

1. **问文财 (pywencai)** - 主要数据源
   - 成交额排名
   - 热度排名
   - 实时数据

2. **AKShare** - 备用数据源
   - K线数据
   - 技术指标
   - 历史数据

3. **东方财富** - 备用数据源
   - K线数据
   - 行情数据

### ❓ 数据更新频率是多少？

**回答**:

- **成交额数据**: 实时更新
- **热度数据**: 实时更新
- **K线数据**: 日线数据，每日收盘后更新

---

## 功能使用相关

### ❓ 如何导出筛选结果？

**回答**:

1. 完成筛选任务，等待进度100%
2. 点击"📊 导出报告"按钮
3. 自动下载Excel文件
4. 文件包含所有筛选结果和详细数据

### ❓ 筛选规则是什么？

**回答**:

详细的筛选规则请查看首页底部的"📋 筛选规则说明"，包括：

1. **动量分数计算**
   ```
   动量分数 = 斜率 × R² × 10000
   ```

2. **综合评分计算**
   ```
   综合评分 = 0.5 × 标准化成交额 + 0.5 × 标准化热度
   ```

3. **筛选条件**
   - ❌ 排除ST股票
   - ❌ 排除次新股（上市<60天）
   - ✅ 成交额Top100
   - ✅ 热度Top100
   - ✅ K线数据充足（≥20天）

4. **排序规则**
   - 按动量分数从高到低排序
   - 🥇 金牌: 第1-3名
   - 🥈 银牌: 第4-10名

### ❓ 如何查看股票详情？

**回答**:

1. 在筛选结果中找到目标股票
2. 点击"详情"按钮
3. 查看K线图和技术指标
4. 包括MA、MACD、RSI、BOLL、KDJ等指标

### ❓ CLI工具如何使用？

**回答**:

```bash
# 查看帮助
./cli.py --help

# 筛选股票
./cli.py screen --date 2025-10-14

# 查看股票详情
./cli.py stock 688981

# 查看K线图
./cli.py kline 688981 --days 60
```

详细说明请查看: `docs/guides/CLI使用指南.md`

---

## 技术问题

### ❓ 如何启动项目？

**回答**:

**方法1: 使用脚本**
```bash
# 启动所有服务（前端+后端）
./scripts/start/start-all.sh

# 停止所有服务
./scripts/start/stop-all.sh
```

**方法2: 手动启动**
```bash
# 启动后端
cd stockguru-web/backend
./venv/bin/uvicorn app.main:app --host 0.0.0.0 --port 8000

# 启动前端
cd frontend
npm run dev
```

### ❓ 如何安装依赖？

**回答**:

**后端依赖**:
```bash
cd stockguru-web/backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

**前端依赖**:
```bash
cd frontend
npm install
```

### ❓ 遇到错误怎么办？

**回答**:

1. **查看日志**
   ```bash
   # 后端日志
   tail -f logs/stockguru.log
   
   # 前端日志
   # 查看浏览器控制台
   ```

2. **常见错误**
   - 端口被占用: 修改端口或停止占用进程
   - 依赖缺失: 重新安装依赖
   - 数据源错误: 检查网络连接

3. **获取帮助**
   - 查看文档: `docs/`
   - 查看报告: `docs/reports/`
   - 查看指南: `docs/guides/`

---

## 其他问题

### ❓ 项目支持哪些平台？

**回答**:

- ✅ macOS
- ✅ Linux
- ✅ Windows (WSL推荐)

### ❓ 数据是否准确？

**回答**:

- 数据来自公开的第三方数据源
- 仅供学习和复盘参考
- 不构成任何投资建议
- 投资有风险，决策需谨慎

### ❓ 可以用于实盘交易吗？

**回答**:

**⚠️ 不建议！**

本工具仅用于：
- 📚 学习量化投资
- 📊 历史数据复盘
- 🔍 技术分析研究

**不适用于**:
- ❌ 实盘交易决策
- ❌ 投资建议
- ❌ 风险评估

---

## 📝 反馈与建议

如果您有其他问题或建议，欢迎：

1. 查看项目文档: `docs/`
2. 查看开发报告: `docs/reports/`
3. 查看使用指南: `docs/guides/`

---

## 📚 相关文档

- [README.md](../README.md) - 项目介绍
- [PRD.md](../prd.md) - 产品需求文档
- [CLI使用指南](guides/CLI使用指南.md) - CLI工具说明
- [快速参考手册](guides/QUICK-REFERENCE.md) - 快速参考
- [筛选规则说明更新](reports/筛选规则说明更新.md) - 详细的筛选规则
- [系统架构分析](reports/系统架构与功能需求分析报告.md) - 系统架构

---

*最后更新: 2025-10-15 04:40*
