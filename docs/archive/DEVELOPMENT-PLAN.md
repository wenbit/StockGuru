# 🚀 StockGuru 开发计划

**制定时间**: 2025-10-15  
**当前版本**: v0.5 (67%)  
**目标版本**: v1.0 (100%)  
**预计完成**: 2025-11-15

---

## 📅 第一阶段：真实数据集成 (v0.8)

**时间**: 2025-10-15 ~ 2025-10-22 (1周)  
**目标完成度**: 85%  
**核心目标**: 让系统能够使用真实数据进行筛选

### 🎯 任务清单

#### 1. 修复 Supabase 连接 🔴
**优先级**: 最高  
**预计时间**: 1-2 小时  
**负责模块**: `app/core/supabase.py`

**任务**:
- [ ] 升级 httpx 到 0.27.0
- [ ] 测试 Supabase 连接
- [ ] 验证数据库操作
- [ ] 更新环境变量配置

**验收标准**:
- ✅ Supabase 客户端初始化成功
- ✅ 可以读写 tasks 表
- ✅ 可以读写 results 表

---

#### 2. 集成 pywencai 数据源 🔴
**优先级**: 最高  
**预计时间**: 4-6 小时  
**负责模块**: `app/services/modules/data_fetcher.py`

**任务**:
- [ ] 实现成交额数据获取
- [ ] 实现热度数据获取
- [ ] 添加错误处理和重试
- [ ] 添加数据验证
- [ ] 编写单元测试

**实现代码**:
```python
def fetch_volume_ranking(self, date: str, top_n: int = 100):
    """获取成交额排名"""
    query = f'{date}成交额前{top_n}'
    df = pywencai.get(query=query)
    # 数据处理和验证
    return processed_data

def fetch_hot_ranking(self, date: str, top_n: int = 100):
    """获取热度排名"""
    query = f'{date}个股热度前{top_n}'
    df = pywencai.get(query=query)
    # 数据处理和验证
    return processed_data
```

**验收标准**:
- ✅ 能成功获取成交额 Top100
- ✅ 能成功获取热度 Top100
- ✅ 数据格式正确
- ✅ 错误处理完善

---

#### 3. 集成 akshare K线数据 🔴
**优先级**: 最高  
**预计时间**: 2-3 小时  
**负责模块**: `app/services/modules/momentum_calculator.py`

**任务**:
- [ ] 实现 K线数据获取
- [ ] 实现动量计算
- [ ] 添加数据缓存
- [ ] 添加错误处理
- [ ] 编写单元测试

**实现代码**:
```python
def fetch_kline_data(self, stock_code: str, date: str, days: int = 25):
    """获取K线数据"""
    df = akshare.stock_zh_a_hist(
        symbol=stock_code,
        period="daily",
        start_date=start_date,
        end_date=date
    )
    return df

def calculate_momentum(self, stocks: List[Dict], date: str):
    """计算动量分数"""
    for stock in stocks:
        kline = self.fetch_kline_data(stock['code'], date, 25)
        momentum = self._linear_regression(kline)
        stock['momentum_score'] = momentum
    return sorted(stocks, key=lambda x: x['momentum_score'], reverse=True)
```

**验收标准**:
- ✅ 能成功获取 K线数据
- ✅ 动量计算正确
- ✅ 性能可接受 (<2分钟)
- ✅ 错误处理完善

---

#### 4. 端到端测试 🟡
**优先级**: 高  
**预计时间**: 2 小时  
**负责模块**: 全系统

**任务**:
- [ ] 测试完整筛选流程
- [ ] 验证数据准确性
- [ ] 性能测试
- [ ] 压力测试

**验收标准**:
- ✅ 完整流程可运行
- ✅ 筛选结果合理
- ✅ 性能达标 (<2分钟)
- ✅ 无严重错误

---

### 📊 第一阶段里程碑

**完成标志**:
- ✅ 所有数据源集成完成
- ✅ 真实数据筛选可用
- ✅ 数据持久化正常
- ✅ 性能达标

**发布内容**:
- v0.8 版本发布
- 更新文档
- 发布说明

---

## 📅 第二阶段：可视化增强 (v0.9)

**时间**: 2025-10-22 ~ 2025-10-29 (1周)  
**目标完成度**: 95%  
**核心目标**: 完善可视化功能

### 🎯 任务清单

#### 5. K线图表组件 🟡
**优先级**: 中  
**预计时间**: 4-6 小时  
**负责模块**: `frontend/components/StockChart.tsx`

**任务**:
- [ ] 选择图表库 (ECharts/Recharts)
- [ ] 实现 K线图组件
- [ ] 添加 MA5/MA10/MA20 均线
- [ ] 添加成交量柱状图
- [ ] 响应式设计

**实现代码**:
```typescript
import { Line } from 'recharts'

function StockChart({ stockCode, data }) {
  return (
    <div className="stock-chart">
      <h3>{stockCode} K线图</h3>
      <Line data={data.kline} />
      <Line data={data.ma5} />
      <Line data={data.ma10} />
      <Line data={data.ma20} />
    </div>
  )
}
```

**验收标准**:
- ✅ K线图显示正确
- ✅ 均线显示正确
- ✅ 交互流畅
- ✅ 移动端适配

---

#### 6. 股票详情页 🟡
**优先级**: 中  
**预计时间**: 4-5 小时  
**负责模块**: `frontend/app/stock/[code]/page.tsx`

**任务**:
- [ ] 创建详情页路由
- [ ] 实现股票信息展示
- [ ] 集成 K线图组件
- [ ] 添加技术指标
- [ ] 添加返回导航

**页面结构**:
```
股票详情页
├── 基础信息卡片
│   ├── 代码、名称
│   ├── 收盘价、涨跌幅
│   └── 动量分数、综合评分
├── K线图表
│   ├── K线图
│   ├── MA5/MA10/MA20
│   └── 成交量
└── 技术指标
    ├── MACD
    └── RSI
```

**验收标准**:
- ✅ 页面布局合理
- ✅ 信息展示完整
- ✅ K线图正常显示
- ✅ 导航流畅

---

#### 7. 历史记录功能 🟡
**优先级**: 中  
**预计时间**: 3-4 小时  
**负责模块**: `frontend/app/history/page.tsx`

**任务**:
- [ ] 创建历史记录页面
- [ ] 实现任务列表展示
- [ ] 添加筛选和排序
- [ ] 实现详情查看
- [ ] 添加对比功能

**页面结构**:
```
历史记录页
├── 筛选条件
│   ├── 日期范围
│   └── 状态筛选
├── 任务列表
│   ├── 日期
│   ├── 状态
│   ├── 结果数量
│   └── 操作按钮
└── 详情弹窗
    └── 完整结果展示
```

**验收标准**:
- ✅ 列表展示正常
- ✅ 筛选功能可用
- ✅ 详情查看正常
- ✅ 对比功能可用

---

### 📊 第二阶段里程碑

**完成标志**:
- ✅ K线图表完整展示
- ✅ 股票详情页可用
- ✅ 历史记录功能完善
- ✅ 用户体验良好

**发布内容**:
- v0.9 版本发布
- 更新文档
- 用户指南

---

## 📅 第三阶段：功能完善 (v1.0)

**时间**: 2025-10-29 ~ 2025-11-15 (2-3周)  
**目标完成度**: 100%  
**核心目标**: 完成所有功能，优化性能

### 🎯 任务清单

#### 8. HTML 报告导出 🟢
**优先级**: 低  
**预计时间**: 3-4 小时

**任务**:
- [ ] 实现报告模板
- [ ] 生成 HTML 文件
- [ ] 添加下载功能
- [ ] 支持离线查看

---

#### 9. 命令行工具 🟢
**优先级**: 低  
**预计时间**: 2-3 小时

**任务**:
- [ ] 创建 CLI 入口
- [ ] 实现参数解析
- [ ] 添加帮助文档
- [ ] 发布到 PyPI

---

#### 10. 性能优化 🟢
**优先级**: 低  
**预计时间**: 2-3 小时

**任务**:
- [ ] 并发数据获取
- [ ] 添加数据缓存
- [ ] 优化数据库查询
- [ ] 前端性能优化

---

#### 11. 文档完善 🟢
**优先级**: 低  
**预计时间**: 2-3 小时

**任务**:
- [ ] 用户使用手册
- [ ] API 文档
- [ ] 部署指南
- [ ] 常见问题

---

### 📊 第三阶段里程碑

**完成标志**:
- ✅ 所有功能完成
- ✅ 性能达标
- ✅ 文档齐全
- ✅ 可以对外发布

**发布内容**:
- v1.0 正式版发布
- 完整文档
- 发布公告

---

## 📈 总体进度追踪

### 进度表

| 阶段 | 开始日期 | 结束日期 | 任务数 | 完成度 | 状态 |
|------|---------|---------|--------|--------|------|
| v0.5 | 2025-10-14 | 2025-10-14 | - | 67% | ✅ 完成 |
| v0.8 | 2025-10-15 | 2025-10-22 | 4 | 0% | 🎯 进行中 |
| v0.9 | 2025-10-22 | 2025-10-29 | 3 | 0% | ⏳ 待开始 |
| v1.0 | 2025-10-29 | 2025-11-15 | 4 | 0% | ⏳ 待开始 |

### 工作量统计

| 优先级 | 任务数 | 预计时间 | 实际时间 | 差异 |
|--------|--------|----------|----------|------|
| 🔴 高 | 3 | 7-11h | - | - |
| 🟡 中 | 3 | 11-15h | - | - |
| 🟢 低 | 4 | 9-13h | - | - |
| **总计** | **10** | **27-39h** | **-** | **-** |

---

## 🎯 立即开始：第一阶段第一天

### 今天的任务 (2025-10-15)

**目标**: 完成 Supabase 连接修复和 pywencai 集成

#### 任务 1: 修复 Supabase 连接 (1-2h)
- [ ] 升级依赖
- [ ] 测试连接
- [ ] 验证功能

#### 任务 2: 开始 pywencai 集成 (2-3h)
- [ ] 实现成交额数据获取
- [ ] 实现热度数据获取
- [ ] 基础测试

**预期产出**:
- Supabase 连接正常
- pywencai 基础功能可用

---

## 📝 每日更新

### 2025-10-15
- [ ] Supabase 连接修复
- [ ] pywencai 成交额数据
- [ ] pywencai 热度数据

### 2025-10-16
- [ ] pywencai 完善和测试
- [ ] akshare K线数据集成

### 2025-10-17
- [ ] 动量计算实现
- [ ] 端到端测试

### 2025-10-18-21
- [ ] 问题修复
- [ ] 性能优化
- [ ] 文档更新

### 2025-10-22
- [ ] v0.8 发布

---

**开始执行！** 🚀
