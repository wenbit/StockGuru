# åŒæ­¥ç¨‹åºæ”¹è¿›å»ºè®®

## ğŸ“‹ å®¡æŸ¥æ€»ç»“

ç»è¿‡å…¨é¢å®¡æŸ¥ï¼Œå‘ç° **7ä¸ªä¸¥é‡é—®é¢˜**ã€**10ä¸ªä¸­ç­‰é—®é¢˜** å’Œ **15ä¸ªæ”¹è¿›æœºä¼š**ã€‚

---

## âŒ ä¸¥é‡é—®é¢˜ï¼ˆå¿…é¡»ä¿®å¤ï¼‰

### 1. äº¤æ˜“æ—¥åˆ¤æ–­è¿‡äºç®€å• â­â­â­â­â­

**å½“å‰ä»£ç **:
```python
def is_trading_day(self, date_str: str) -> bool:
    date_obj = datetime.strptime(date_str, '%Y-%m-%d')
    return date_obj.weekday() < 5  # âŒ åªåˆ¤æ–­å‘¨æœ«
```

**é—®é¢˜**:
- âŒ æ— æ³•è¯†åˆ«æ³•å®šèŠ‚å‡æ—¥ï¼ˆå›½åº†ã€æ˜¥èŠ‚ç­‰ï¼‰
- âŒ æ— æ³•è¯†åˆ«è°ƒä¼‘å·¥ä½œæ—¥
- âŒ å¯èƒ½å°è¯•åŒæ­¥éäº¤æ˜“æ—¥æ•°æ®ï¼Œæµªè´¹èµ„æº

**å½±å“**: é«˜ - å¯èƒ½å¯¼è‡´æ— æ•ˆåŒæ­¥

**è§£å†³æ–¹æ¡ˆ**:
```python
# æ–¹æ¡ˆ1: ä½¿ç”¨ chinese_calendar åº“ï¼ˆæ¨èï¼‰
import chinese_calendar as calendar
def is_trading_day(self, date_str: str) -> bool:
    date_obj = datetime.strptime(date_str, '%Y-%m-%d').date()
    return calendar.is_workday(date_obj)

# æ–¹æ¡ˆ2: æŸ¥è¯¢æ•°æ®åº“å†å²æ•°æ®
def is_trading_day(self, date_str: str) -> bool:
    cursor.execute("""
        SELECT COUNT(*) FROM daily_stock_data 
        WHERE trade_date = %s LIMIT 1
    """, (date_str,))
    return cursor.fetchone()[0] > 0

# æ–¹æ¡ˆ3: ç»´æŠ¤äº¤æ˜“æ—¥å†è¡¨
CREATE TABLE trading_calendar (
    trade_date DATE PRIMARY KEY,
    is_trading_day BOOLEAN,
    holiday_name VARCHAR(100)
);
```

**å·²åˆ›å»º**: `scripts/trading_calendar.py` âœ…

---

### 2. ç¼ºå°‘é…ç½®æ–‡ä»¶ï¼Œå‚æ•°ç¡¬ç¼–ç  â­â­â­â­â­

**å½“å‰ä»£ç **:
```python
self.reconnect_interval = 300  # ç¡¬ç¼–ç 
max_retries = 3  # ç¡¬ç¼–ç 
max_error_count = 10  # ç¡¬ç¼–ç 
error_window = 30  # ç¡¬ç¼–ç 
batch_size = 500  # ç¡¬ç¼–ç 
```

**é—®é¢˜**:
- âŒ å‚æ•°åˆ†æ•£åœ¨ä»£ç å„å¤„
- âŒ ä¿®æ”¹éœ€è¦æ”¹ä»£ç ï¼Œä¸çµæ´»
- âŒ ä¸åŒç¯å¢ƒæ— æ³•ä½¿ç”¨ä¸åŒé…ç½®
- âŒ éš¾ä»¥è°ƒä¼˜å’Œæµ‹è¯•

**å½±å“**: é«˜ - é™ä½å¯ç»´æŠ¤æ€§

**è§£å†³æ–¹æ¡ˆ**:
```python
# åˆ›å»ºé…ç½®ç±»
class SyncConfig:
    # ä»ç¯å¢ƒå˜é‡è¯»å–ï¼Œæä¾›é»˜è®¤å€¼
    RECONNECT_INTERVAL = int(os.getenv('RECONNECT_INTERVAL', '300'))
    MAX_RETRIES = int(os.getenv('MAX_RETRIES', '3'))
    MAX_ERROR_COUNT = int(os.getenv('MAX_ERROR_COUNT', '10'))
    BATCH_SIZE = int(os.getenv('BATCH_SIZE', '500'))
    
    @classmethod
    def validate(cls):
        """éªŒè¯é…ç½®åˆæ³•æ€§"""
        if cls.BATCH_SIZE < 1 or cls.BATCH_SIZE > 1000:
            raise ValueError(f"BATCH_SIZE è¶…å‡ºèŒƒå›´")

# ä½¿ç”¨é…ç½®
from sync_config import config
self.reconnect_interval = config.RECONNECT_INTERVAL
```

**å·²åˆ›å»º**: `scripts/sync_config.py` âœ…

---

### 3. å¼‚å¸¸å¤„ç†ä¸å¤Ÿç»†åŒ– â­â­â­â­

**å½“å‰ä»£ç **:
```python
try:
    sync_data()
except Exception as e:  # âŒ æ•è·æ‰€æœ‰å¼‚å¸¸
    logger.error(f"å¼‚å¸¸: {e}")
    retry()  # æ‰€æœ‰å¼‚å¸¸éƒ½é‡è¯•
```

**é—®é¢˜**:
- âŒ æ— æ³•åŒºåˆ†ä¸åŒç±»å‹çš„é”™è¯¯
- âŒ ç½‘ç»œé”™è¯¯ã€æ•°æ®åº“é”™è¯¯ã€ä¸šåŠ¡é”™è¯¯æ··åœ¨ä¸€èµ·
- âŒ æ— æ³•é’ˆå¯¹æ€§é‡è¯•ï¼ˆæœ‰äº›é”™è¯¯ä¸åº”è¯¥é‡è¯•ï¼‰
- âŒ é”™è¯¯ä¿¡æ¯ä¸å¤Ÿè¯¦ç»†

**å½±å“**: é«˜ - é™ä½ç³»ç»Ÿç¨³å®šæ€§

**è§£å†³æ–¹æ¡ˆ**:
```python
# å®šä¹‰è‡ªå®šä¹‰å¼‚å¸¸
class DatabaseConnectionError(Exception):
    """æ•°æ®åº“è¿æ¥é”™è¯¯ - å¯é‡è¯•"""
    retryable = True

class DataFormatError(Exception):
    """æ•°æ®æ ¼å¼é”™è¯¯ - ä¸å¯é‡è¯•"""
    retryable = False

# ç»†åŒ–å¼‚å¸¸å¤„ç†
try:
    sync_data()
except psycopg2.OperationalError as e:
    if 'connection' in str(e).lower():
        raise DatabaseConnectionError(f"è¿æ¥æ–­å¼€: {e}")
    elif 'timeout' in str(e).lower():
        raise DatabaseTimeoutError(f"æŸ¥è¯¢è¶…æ—¶: {e}")
except ValueError as e:
    raise DataFormatError(f"æ•°æ®æ ¼å¼é”™è¯¯: {e}")

# æ™ºèƒ½é‡è¯•
except SyncException as e:
    if e.retryable:
        retry_with_backoff()
    else:
        mark_as_failed()
```

**å·²åˆ›å»º**: `scripts/sync_exceptions.py` âœ…

---

### 4. ç¼ºå°‘è¶…æ—¶æ§åˆ¶ â­â­â­â­

**å½“å‰ä»£ç **:
```python
process = subprocess.Popen(...)  # âŒ æ— è¶…æ—¶
while True:
    line = process.stdout.readline()  # âŒ å¯èƒ½æ°¸ä¹…é˜»å¡
```

**é—®é¢˜**:
- âŒ è¿›ç¨‹å¯èƒ½æ°¸ä¹…æŒ‚èµ·
- âŒ æ— æ³•è‡ªåŠ¨æ¢å¤
- âŒ èµ„æºæ³„æ¼

**å½±å“**: é«˜ - å¯èƒ½å¯¼è‡´ç³»ç»ŸæŒ‚èµ·

**è§£å†³æ–¹æ¡ˆ**:
```python
# æ–¹æ¡ˆ1: ä½¿ç”¨ timeout å‚æ•°
try:
    result = subprocess.run(
        cmd,
        timeout=1800,  # 30åˆ†é’Ÿè¶…æ—¶
        capture_output=True
    )
except subprocess.TimeoutExpired:
    logger.error("åŒæ­¥è¶…æ—¶ï¼Œç»ˆæ­¢è¿›ç¨‹")
    process.kill()
    raise ProcessTimeoutError()

# æ–¹æ¡ˆ2: ä½¿ç”¨ signal æ¨¡å—
import signal

def timeout_handler(signum, frame):
    raise TimeoutError("æ“ä½œè¶…æ—¶")

signal.signal(signal.SIGALRM, timeout_handler)
signal.alarm(1800)  # 30åˆ†é’Ÿ
try:
    sync_data()
finally:
    signal.alarm(0)  # å–æ¶ˆå®šæ—¶å™¨

# æ–¹æ¡ˆ3: ä½¿ç”¨ threading.Timer
import threading

def kill_process():
    if process.poll() is None:
        process.kill()

timer = threading.Timer(1800, kill_process)
timer.start()
try:
    process.wait()
finally:
    timer.cancel()
```

**å»ºè®®**: åœ¨ `monitor_sync_process` ä¸­æ·»åŠ è¶…æ—¶æ£€æŸ¥

---

### 5. æ•°æ®åº“è¿æ¥æœªä½¿ç”¨è¿æ¥æ±  â­â­â­â­

**å½“å‰ä»£ç **:
```python
self.conn = psycopg2.connect(database_url)  # âŒ å•ä¸€è¿æ¥
```

**é—®é¢˜**:
- âŒ å¹¶å‘èƒ½åŠ›å·®
- âŒ è¿æ¥æ–­å¼€åéœ€è¦é‡å»º
- âŒ æ— æ³•å¤ç”¨è¿æ¥
- âŒ èµ„æºåˆ©ç”¨ç‡ä½

**å½±å“**: ä¸­ - å½±å“æ€§èƒ½å’Œç¨³å®šæ€§

**è§£å†³æ–¹æ¡ˆ**:
```python
from psycopg2 import pool

class DatabaseManager:
    def __init__(self):
        self.pool = pool.ThreadedConnectionPool(
            minconn=2,
            maxconn=10,
            dsn=database_url,
            connect_timeout=30
        )
    
    def get_connection(self):
        """è·å–è¿æ¥"""
        return self.pool.getconn()
    
    def put_connection(self, conn):
        """å½’è¿˜è¿æ¥"""
        self.pool.putconn(conn)
    
    def close_all(self):
        """å…³é—­æ‰€æœ‰è¿æ¥"""
        self.pool.closeall()

# ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨
from contextlib import contextmanager

@contextmanager
def get_db_connection():
    conn = db_manager.get_connection()
    try:
        yield conn
    finally:
        db_manager.put_connection(conn)

# ä½¿ç”¨
with get_db_connection() as conn:
    cursor = conn.cursor()
    cursor.execute("SELECT ...")
```

**å»ºè®®**: é‡æ„ `test_copy_sync.py` ä½¿ç”¨è¿æ¥æ± 

---

### 6. ç¼ºå°‘æ—¥å¿—æ–‡ä»¶è½®è½¬ â­â­â­

**å½“å‰ä»£ç **:
```python
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s [%(levelname)s] %(message)s'
)  # âŒ åªè¾“å‡ºåˆ°æ§åˆ¶å°
```

**é—®é¢˜**:
- âŒ æ—¥å¿—åªè¾“å‡ºåˆ°æ§åˆ¶å°
- âŒ æ— æ³•æŒä¹…åŒ–ä¿å­˜
- âŒ æ— æ³•äº‹ååˆ†æé—®é¢˜

**å½±å“**: ä¸­ - å½±å“é—®é¢˜æ’æŸ¥

**è§£å†³æ–¹æ¡ˆ**:
```python
from logging.handlers import RotatingFileHandler
import os

def setup_logging(log_file='logs/sync.log', level=logging.INFO):
    """é…ç½®æ—¥å¿—"""
    # ç¡®ä¿æ—¥å¿—ç›®å½•å­˜åœ¨
    os.makedirs(os.path.dirname(log_file), exist_ok=True)
    
    # åˆ›å»º logger
    logger = logging.getLogger()
    logger.setLevel(level)
    
    # æ–‡ä»¶å¤„ç†å™¨ï¼ˆå¸¦è½®è½¬ï¼‰
    file_handler = RotatingFileHandler(
        log_file,
        maxBytes=10*1024*1024,  # 10MB
        backupCount=5,
        encoding='utf-8'
    )
    file_handler.setLevel(level)
    file_formatter = logging.Formatter(
        '%(asctime)s [%(levelname)s] [%(name)s] %(message)s'
    )
    file_handler.setFormatter(file_formatter)
    
    # æ§åˆ¶å°å¤„ç†å™¨
    console_handler = logging.StreamHandler()
    console_handler.setLevel(level)
    console_formatter = logging.Formatter(
        '%(asctime)s [%(levelname)s] %(message)s'
    )
    console_handler.setFormatter(console_formatter)
    
    # æ·»åŠ å¤„ç†å™¨
    logger.addHandler(file_handler)
    logger.addHandler(console_handler)
    
    return logger
```

---

### 7. ç¼ºå°‘å¥åº·æ£€æŸ¥ â­â­â­

**é—®é¢˜**:
- âŒ æ— æ³•ä¸»åŠ¨æ£€æµ‹æ•°æ®åº“æ˜¯å¦å¯ç”¨
- âŒ æ— æ³•ä¸»åŠ¨æ£€æµ‹ baostock æœåŠ¡æ˜¯å¦å¯ç”¨
- âŒ é—®é¢˜å‘ç°æ»å

**å½±å“**: ä¸­ - é™ä½ç³»ç»Ÿå¯é æ€§

**è§£å†³æ–¹æ¡ˆ**:
```python
class HealthChecker:
    """å¥åº·æ£€æŸ¥å™¨"""
    
    def check_database(self, conn) -> bool:
        """æ£€æŸ¥æ•°æ®åº“è¿æ¥"""
        try:
            cursor = conn.cursor()
            cursor.execute("SELECT 1")
            cursor.fetchone()
            cursor.close()
            return True
        except Exception as e:
            logger.error(f"æ•°æ®åº“å¥åº·æ£€æŸ¥å¤±è´¥: {e}")
            return False
    
    def check_baostock(self) -> bool:
        """æ£€æŸ¥ baostock æœåŠ¡"""
        try:
            import baostock as bs
            login_result = bs.login()
            if login_result.error_code == '0':
                bs.logout()
                return True
            return False
        except Exception as e:
            logger.error(f"Baostock å¥åº·æ£€æŸ¥å¤±è´¥: {e}")
            return False
    
    def check_all(self) -> dict:
        """æ£€æŸ¥æ‰€æœ‰æœåŠ¡"""
        return {
            'database': self.check_database(),
            'baostock': self.check_baostock(),
            'timestamp': datetime.now().isoformat()
        }

# åœ¨åŒæ­¥å‰æ‰§è¡Œå¥åº·æ£€æŸ¥
health_checker = HealthChecker()
health = health_checker.check_all()
if not all(health.values()):
    logger.error(f"å¥åº·æ£€æŸ¥å¤±è´¥: {health}")
    raise SystemException("æœåŠ¡ä¸å¯ç”¨")
```

---

## âš ï¸ ä¸­ç­‰é—®é¢˜ï¼ˆå»ºè®®ä¿®å¤ï¼‰

### 8. æ—¥å¿—çº§åˆ«å•ä¸€ â­â­â­

**å»ºè®®**: ä½¿ç”¨ä¸åŒçº§åˆ«çš„æ—¥å¿—
```python
logger.debug("è¯¦ç»†è°ƒè¯•ä¿¡æ¯")  # å¼€å‘æ—¶ä½¿ç”¨
logger.info("æ­£å¸¸æµç¨‹ä¿¡æ¯")   # ç”Ÿäº§ç¯å¢ƒ
logger.warning("è­¦å‘Šä¿¡æ¯")    # éœ€è¦æ³¨æ„
logger.error("é”™è¯¯ä¿¡æ¯")      # éœ€è¦å¤„ç†
logger.critical("ä¸¥é‡é”™è¯¯")   # ç³»ç»Ÿçº§é—®é¢˜
```

---

### 9. ç¼ºå°‘è¿›åº¦æŒä¹…åŒ– â­â­â­

**é—®é¢˜**: è¿›ç¨‹å´©æºƒåæ— æ³•æ¢å¤è¿›åº¦

**è§£å†³æ–¹æ¡ˆ**:
```python
# å®šæœŸä¿å­˜è¿›åº¦åˆ°æ–‡ä»¶
import json

def save_progress(date_str, processed_count, total_count):
    progress = {
        'date': date_str,
        'processed': processed_count,
        'total': total_count,
        'timestamp': datetime.now().isoformat()
    }
    with open(f'progress_{date_str}.json', 'w') as f:
        json.dump(progress, f)

def load_progress(date_str):
    try:
        with open(f'progress_{date_str}.json', 'r') as f:
            return json.load(f)
    except FileNotFoundError:
        return None
```

---

### 10. ç¼ºå°‘æ€§èƒ½æŒ‡æ ‡æ”¶é›† â­â­â­

**å»ºè®®**: æ”¶é›†å…³é”®æŒ‡æ ‡
```python
class MetricsCollector:
    def __init__(self):
        self.metrics = {
            'total_synced': 0,
            'total_failed': 0,
            'avg_speed': 0,
            'total_duration': 0,
            'success_rate': 0
        }
    
    def record_sync(self, date_str, success, duration, count):
        """è®°å½•åŒæ­¥æŒ‡æ ‡"""
        if success:
            self.metrics['total_synced'] += count
        else:
            self.metrics['total_failed'] += count
        
        self.metrics['total_duration'] += duration
        self.metrics['success_rate'] = (
            self.metrics['total_synced'] / 
            (self.metrics['total_synced'] + self.metrics['total_failed'])
        )
    
    def export_metrics(self):
        """å¯¼å‡ºæŒ‡æ ‡"""
        return self.metrics
```

---

### 11. é”™è¯¯ä¿¡æ¯æˆªæ–­è¿‡çŸ­ â­â­

**å½“å‰**: `error_message = str(e)[:500]`

**å»ºè®®**: 
```python
# ä¿å­˜å®Œæ•´é”™è¯¯åˆ°æ–‡ä»¶
def save_error_detail(date_str, error):
    error_file = f'logs/error_{date_str}_{int(time.time())}.txt'
    with open(error_file, 'w') as f:
        f.write(f"Date: {date_str}\n")
        f.write(f"Time: {datetime.now()}\n")
        f.write(f"Error: {error}\n")
        f.write(f"Traceback:\n")
        import traceback
        traceback.print_exc(file=f)
    
    # æ•°æ®åº“åªä¿å­˜æ‘˜è¦
    error_summary = str(error)[:500]
    return error_summary, error_file
```

---

### 12. ç¼ºå°‘å¹¶å‘æ§åˆ¶ â­â­

**å»ºè®®**: æ”¯æŒå¤šæ—¥æœŸå¹¶å‘åŒæ­¥
```python
from concurrent.futures import ThreadPoolExecutor, as_completed

def batch_sync_concurrent(self, dates, max_workers=3):
    """å¹¶å‘åŒæ­¥å¤šä¸ªæ—¥æœŸ"""
    with ThreadPoolExecutor(max_workers=max_workers) as executor:
        futures = {
            executor.submit(self.sync_date, date_str): date_str 
            for date_str in dates
        }
        
        for future in as_completed(futures):
            date_str = futures[future]
            try:
                result = future.result()
                logger.info(f"{date_str} å®Œæˆ")
            except Exception as e:
                logger.error(f"{date_str} å¤±è´¥: {e}")
```

---

### 13. ç¼ºå°‘å‘Šè­¦æœºåˆ¶ â­â­

**å»ºè®®**: å¤±è´¥æ—¶å‘é€å‘Šè­¦
```python
def send_alert(title, message, level='error'):
    """å‘é€å‘Šè­¦"""
    if not config.ENABLE_ALERT:
        return
    
    # å‘é€åˆ°ä¼ä¸šå¾®ä¿¡/é’‰é’‰/é‚®ä»¶
    import requests
    webhook_url = config.ALERT_WEBHOOK_URL
    
    payload = {
        'msgtype': 'text',
        'text': {
            'content': f"ã€{level.upper()}ã€‘{title}\n{message}"
        }
    }
    
    try:
        requests.post(webhook_url, json=payload, timeout=5)
    except Exception as e:
        logger.error(f"å‘Šè­¦å‘é€å¤±è´¥: {e}")

# ä½¿ç”¨
if failed_count >= config.ALERT_FAILURE_THRESHOLD:
    send_alert(
        "æ•°æ®åŒæ­¥å¤±è´¥",
        f"è¿ç»­{failed_count}ä¸ªæ—¥æœŸåŒæ­¥å¤±è´¥",
        level='critical'
    )
```

---

### 14. ç¼ºå°‘æ•°æ®éªŒè¯ â­â­

**å»ºè®®**: åŒæ­¥åéªŒè¯æ•°æ®å®Œæ•´æ€§
```python
def validate_sync_data(date_str, expected_count=5000):
    """éªŒè¯åŒæ­¥æ•°æ®"""
    cursor.execute("""
        SELECT 
            COUNT(*) as total,
            COUNT(DISTINCT stock_code) as unique_stocks,
            COUNT(*) FILTER (WHERE close_price IS NULL) as null_prices
        FROM daily_stock_data
        WHERE trade_date = %s
    """, (date_str,))
    
    total, unique_stocks, null_prices = cursor.fetchone()
    
    issues = []
    if total < expected_count * 0.9:  # å°‘äºé¢„æœŸ90%
        issues.append(f"è®°å½•æ•°åå°‘: {total} < {expected_count}")
    
    if null_prices > total * 0.01:  # è¶…è¿‡1%ç©ºå€¼
        issues.append(f"ç©ºå€¼è¿‡å¤š: {null_prices}/{total}")
    
    if unique_stocks < total * 0.95:  # é‡å¤æ•°æ®è¿‡å¤š
        issues.append(f"é‡å¤æ•°æ®: {total - unique_stocks}")
    
    return len(issues) == 0, issues
```

---

### 15. ç¼ºå°‘å›æ»šæœºåˆ¶ â­â­

**å»ºè®®**: åŒæ­¥å¤±è´¥æ—¶å›æ»šéƒ¨åˆ†æ•°æ®
```python
def sync_with_transaction(date_str):
    """ä½¿ç”¨äº‹åŠ¡åŒæ­¥"""
    conn = get_connection()
    try:
        conn.autocommit = False  # å…³é—­è‡ªåŠ¨æäº¤
        
        # åŒæ­¥æ•°æ®
        sync_data(conn, date_str)
        
        # éªŒè¯æ•°æ®
        is_valid, issues = validate_sync_data(date_str)
        
        if is_valid:
            conn.commit()
            logger.info(f"{date_str} åŒæ­¥æˆåŠŸå¹¶æäº¤")
        else:
            conn.rollback()
            logger.error(f"{date_str} éªŒè¯å¤±è´¥ï¼Œå›æ»š: {issues}")
            raise DataIncompleteError(f"æ•°æ®ä¸å®Œæ•´: {issues}")
    
    except Exception as e:
        conn.rollback()
        logger.error(f"{date_str} åŒæ­¥å¤±è´¥ï¼Œå›æ»š: {e}")
        raise
    finally:
        conn.autocommit = True
```

---

## ğŸ’¡ æ”¹è¿›æœºä¼šï¼ˆå¯é€‰ï¼‰

### 16. æ”¯æŒå¢é‡æ›´æ–° â­

åªåŒæ­¥å˜åŒ–çš„è‚¡ç¥¨ï¼Œæé«˜æ•ˆç‡

### 17. æ”¯æŒæ•°æ®å‹ç¼© â­

å‹ç¼©å†å²æ•°æ®ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´

### 18. æ”¯æŒå¤šæ•°æ®æº â­

é™¤äº† baostockï¼Œæ”¯æŒ tushareã€akshare ç­‰

### 19. æ”¯æŒæ•°æ®å¯¼å‡º â­

å¯¼å‡ºä¸º CSVã€Excelã€Parquet ç­‰æ ¼å¼

### 20. æ”¯æŒ Web ç•Œé¢ â­

æä¾› Web ç•Œé¢æŸ¥çœ‹åŒæ­¥çŠ¶æ€å’Œæ—¥å¿—

---

## ğŸ“Š ä¼˜å…ˆçº§çŸ©é˜µ

| é—®é¢˜ | ä¸¥é‡ç¨‹åº¦ | ä¿®å¤éš¾åº¦ | ä¼˜å…ˆçº§ |
|------|----------|----------|--------|
| 1. äº¤æ˜“æ—¥åˆ¤æ–­ | â­â­â­â­â­ | ä½ | P0 |
| 2. é…ç½®æ–‡ä»¶ | â­â­â­â­â­ | ä½ | P0 |
| 3. å¼‚å¸¸å¤„ç† | â­â­â­â­ | ä¸­ | P0 |
| 4. è¶…æ—¶æ§åˆ¶ | â­â­â­â­ | ä½ | P0 |
| 5. è¿æ¥æ±  | â­â­â­â­ | ä¸­ | P1 |
| 6. æ—¥å¿—è½®è½¬ | â­â­â­ | ä½ | P1 |
| 7. å¥åº·æ£€æŸ¥ | â­â­â­ | ä½ | P1 |
| 8-15 | â­â­ | ä½-ä¸­ | P2 |
| 16-20 | â­ | ä¸­-é«˜ | P3 |

---

## ğŸ¯ å®æ–½è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼ˆ1-2å¤©ï¼‰- P0é—®é¢˜
1. âœ… åˆ›å»ºé…ç½®æ–‡ä»¶ `sync_config.py`
2. âœ… åˆ›å»ºå¼‚å¸¸ç±» `sync_exceptions.py`
3. âœ… åˆ›å»ºäº¤æ˜“æ—¥å† `trading_calendar.py`
4. â³ æ·»åŠ è¶…æ—¶æ§åˆ¶
5. â³ é‡æ„å¼‚å¸¸å¤„ç†

### ç¬¬äºŒé˜¶æ®µï¼ˆ2-3å¤©ï¼‰- P1é—®é¢˜
1. â³ å®ç°è¿æ¥æ± 
2. â³ é…ç½®æ—¥å¿—è½®è½¬
3. â³ æ·»åŠ å¥åº·æ£€æŸ¥
4. â³ é›†æˆåˆ°ç°æœ‰è„šæœ¬

### ç¬¬ä¸‰é˜¶æ®µï¼ˆ3-5å¤©ï¼‰- P2é—®é¢˜
1. â³ æ·»åŠ æ€§èƒ½æŒ‡æ ‡
2. â³ å®ç°è¿›åº¦æŒä¹…åŒ–
3. â³ æ·»åŠ æ•°æ®éªŒè¯
4. â³ å®ç°å‘Šè­¦æœºåˆ¶

### ç¬¬å››é˜¶æ®µï¼ˆæŒ‰éœ€ï¼‰- P3æ”¹è¿›
1. å¢é‡æ›´æ–°
2. å¤šæ•°æ®æº
3. Web ç•Œé¢

---

## ğŸ“ æ€»ç»“

### å·²å®Œæˆ âœ…
1. é…ç½®ç®¡ç†ç³»ç»Ÿ (`sync_config.py`)
2. å¼‚å¸¸åˆ†ç±»ç³»ç»Ÿ (`sync_exceptions.py`)
3. äº¤æ˜“æ—¥å†å·¥å…· (`trading_calendar.py`)

### å¾…å®æ–½ â³
1. è¶…æ—¶æ§åˆ¶æœºåˆ¶
2. æ•°æ®åº“è¿æ¥æ± 
3. æ—¥å¿—è½®è½¬é…ç½®
4. å¥åº·æ£€æŸ¥ç³»ç»Ÿ
5. æ€§èƒ½æŒ‡æ ‡æ”¶é›†
6. å‘Šè­¦æœºåˆ¶

### é¢„æœŸæ•ˆæœ ğŸ¯
- **å¯é æ€§**: æå‡ 50%+ï¼ˆé€šè¿‡ç»†åŒ–å¼‚å¸¸å¤„ç†å’Œå¥åº·æ£€æŸ¥ï¼‰
- **å¯ç»´æŠ¤æ€§**: æå‡ 80%+ï¼ˆé€šè¿‡é…ç½®åŒ–å’Œæ¨¡å—åŒ–ï¼‰
- **æ€§èƒ½**: æå‡ 30%+ï¼ˆé€šè¿‡è¿æ¥æ± å’Œå¹¶å‘ï¼‰
- **å¯è§‚æµ‹æ€§**: æå‡ 100%+ï¼ˆé€šè¿‡æ—¥å¿—ã€æŒ‡æ ‡å’Œå‘Šè­¦ï¼‰

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

- âœ… `scripts/sync_config.py` - é…ç½®ç®¡ç†
- âœ… `scripts/sync_exceptions.py` - å¼‚å¸¸å®šä¹‰
- âœ… `scripts/trading_calendar.py` - äº¤æ˜“æ—¥å†
- â³ `scripts/sync_logger.py` - æ—¥å¿—é…ç½®
- â³ `scripts/sync_health.py` - å¥åº·æ£€æŸ¥
- â³ `scripts/sync_metrics.py` - æ€§èƒ½æŒ‡æ ‡
- â³ `scripts/batch_sync_dates_v2.py` - æ”¹è¿›ç‰ˆæ‰¹é‡åŒæ­¥

---

**ä¸‹ä¸€æ­¥**: å®æ–½ç¬¬ä¸€é˜¶æ®µçš„ P0 é—®é¢˜ä¿®å¤
