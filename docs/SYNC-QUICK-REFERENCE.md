# æ•°æ®åŒæ­¥å¿«é€Ÿå‚è€ƒ

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# åŒæ­¥å•ä¸ªæ—¥æœŸ
python3 scripts/batch_sync_dates.py --dates 2025-10-14

# åŒæ­¥æ—¥æœŸèŒƒå›´
python3 scripts/batch_sync_dates.py --start 2025-10-10 --end 2025-10-16

# åŒæ­¥å¤šä¸ªæ—¥æœŸ
python3 scripts/batch_sync_dates.py --dates 2025-10-14 2025-10-16 2025-10-17
```

## âœ¨ æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| ğŸ”„ æ–­ç‚¹ç»­ä¼  | è‡ªåŠ¨è·³è¿‡å·²åŒæ­¥è‚¡ç¥¨ï¼ŒèŠ‚çœæ—¶é—´ |
| ğŸ”Œ å®šæœŸé‡è¿ | æ¯5åˆ†é’Ÿä¸»åŠ¨é‡è¿ï¼Œé¿å…è¶…æ—¶ |
| ğŸ” æ™ºèƒ½é‡è¯• | æ¯ä¸ªæ—¥æœŸæœ€å¤šé‡è¯•3æ¬¡ |
| ğŸ‘ï¸ å®æ—¶ç›‘æ§ | æ£€æµ‹æŒç»­é”™è¯¯å¹¶åŠæ—¶ä¸­æ–­ |
| ğŸ“Š è‡ªåŠ¨æ›´æ–° | åŒæ­¥å®Œæˆåè‡ªåŠ¨æ›´æ–°çŠ¶æ€è¡¨ |
| â­ï¸ å¤±è´¥ç»§ç»­ | æŸä¸ªæ—¥æœŸå¤±è´¥åç»§ç»­ä¸‹ä¸€ä¸ª |

## ğŸ“‹ æ‰§è¡Œæµç¨‹

```
æ£€æŸ¥äº¤æ˜“æ—¥ â†’ æ£€æŸ¥å·²åŒæ­¥ â†’ å°è¯•åŒæ­¥(3æ¬¡) â†’ æ›´æ–°çŠ¶æ€è¡¨ â†’ ä¸‹ä¸€ä¸ªæ—¥æœŸ
```

## âš™ï¸ å…³é”®å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| æœ€å¤§é‡è¯•æ¬¡æ•° | 3 | æ¯ä¸ªæ—¥æœŸçš„é‡è¯•æ¬¡æ•° |
| é”™è¯¯é˜ˆå€¼ | 10 | 30ç§’å†…é”™è¯¯æ¬¡æ•°ä¸Šé™ |
| é‡è¿é—´éš” | 300ç§’ | å®šæœŸé‡è¿çš„æ—¶é—´é—´éš” |
| é‡è¯•ç­‰å¾… | 5ç§’ | å¤±è´¥åç­‰å¾…æ—¶é—´ |

## ğŸ“Š çŠ¶æ€è¡¨å­—æ®µ

```sql
daily_sync_status
â”œâ”€â”€ sync_date          -- åŒæ­¥æ—¥æœŸ
â”œâ”€â”€ status             -- success / failed
â”œâ”€â”€ total_records      -- æ€»è®°å½•æ•°
â”œâ”€â”€ success_count      -- æˆåŠŸæ•°é‡
â”œâ”€â”€ start_time         -- å¼€å§‹æ—¶é—´
â”œâ”€â”€ end_time           -- ç»“æŸæ—¶é—´
â”œâ”€â”€ duration_seconds   -- è€—æ—¶ï¼ˆç§’ï¼‰
â””â”€â”€ error_message      -- é”™è¯¯ä¿¡æ¯
```

## ğŸ” æŸ¥è¯¢å‘½ä»¤

```sql
-- æŸ¥çœ‹åŒæ­¥çŠ¶æ€
SELECT sync_date, status, success_count, duration_seconds
FROM daily_sync_status
WHERE sync_date BETWEEN '2025-10-10' AND '2025-10-16'
ORDER BY sync_date;

-- æŸ¥çœ‹å¤±è´¥è®°å½•
SELECT sync_date, error_message
FROM daily_sync_status
WHERE status = 'failed';

-- æŸ¥çœ‹æŸæ—¥æ•°æ®é‡
SELECT COUNT(*) 
FROM daily_stock_data 
WHERE trade_date = '2025-10-14';
```

## ğŸ› ï¸ æ•…éšœå¤„ç†

### é—®é¢˜1: è¿æ¥è¶…æ—¶
âœ… **å·²è‡ªåŠ¨å¤„ç†** - æ¯5åˆ†é’Ÿä¸»åŠ¨é‡è¿

### é—®é¢˜2: æŒç»­é”™è¯¯
âœ… **å·²è‡ªåŠ¨å¤„ç†** - 30ç§’å†…10æ¬¡é”™è¯¯è‡ªåŠ¨ç»ˆæ­¢å¹¶é‡è¯•

### é—®é¢˜3: æ•°æ®ä¸å®Œæ•´
```bash
# 1. åˆ é™¤è¯¥æ—¥æœŸæ•°æ®
DELETE FROM daily_stock_data WHERE trade_date = '2025-10-14';
DELETE FROM daily_sync_status WHERE sync_date = '2025-10-14';

# 2. é‡æ–°åŒæ­¥
python3 scripts/batch_sync_dates.py --dates 2025-10-14
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| å¹³å‡é€Ÿåº¦ | 5.5 è‚¡/ç§’ |
| å•æ—¥è€—æ—¶ | 8-15 åˆ†é’Ÿ |
| æ–­ç‚¹ç»­ä¼ èŠ‚çœ | æœ€é«˜ 87% |
| æˆåŠŸç‡ | 95%+ |

## ğŸ“ ç›¸å…³æ–‡ä»¶

```
scripts/
â”œâ”€â”€ batch_sync_dates.py      # æ‰¹é‡åŒæ­¥è„šæœ¬
â”œâ”€â”€ test_copy_sync.py         # å•æ—¥åŒæ­¥è„šæœ¬
â””â”€â”€ test_batch_sync.sh        # æµ‹è¯•è„šæœ¬

docs/
â”œâ”€â”€ æ‰¹é‡åŒæ­¥ä½¿ç”¨è¯´æ˜.md      # è¯¦ç»†æ–‡æ¡£
â””â”€â”€ æ•°æ®åŒæ­¥ä¼˜åŒ–æ€»ç»“.md      # ä¼˜åŒ–æ€»ç»“
```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æ—¥å¸¸åŒæ­¥**: æ¯å¤©åŒæ­¥å‰ä¸€å¤©æ•°æ®
2. **æ‰¹é‡è¡¥å……**: ä½¿ç”¨æ—¥æœŸèŒƒå›´åŒæ­¥å¤šå¤©
3. **å¤±è´¥é‡è¯•**: åˆ é™¤æ•°æ®åé‡æ–°åŒæ­¥
4. **å®šæœŸæ£€æŸ¥**: æŸ¥è¯¢çŠ¶æ€è¡¨ç¡®è®¤å®Œæ•´æ€§

## ğŸ¯ å¿«é€Ÿè¯Šæ–­

```bash
# æ£€æŸ¥æœ¬å‘¨åŒæ­¥çŠ¶æ€
python3 -c "
import os, psycopg2
from dotenv import load_dotenv
from pathlib import Path
load_dotenv(Path('stockguru-web/backend/.env'))
conn = psycopg2.connect(os.getenv('DATABASE_URL'))
cursor = conn.cursor()
cursor.execute('''
    SELECT sync_date, status, success_count
    FROM daily_sync_status
    WHERE sync_date >= CURRENT_DATE - INTERVAL '7 days'
    ORDER BY sync_date
''')
for row in cursor.fetchall():
    print(f'{row[0]}: {row[1]:8s} - {row[2]:,} æ¡')
cursor.close()
conn.close()
"
```

---

**æç¤º**: è¯¦ç»†æ–‡æ¡£è¯·æŸ¥çœ‹ `docs/æ‰¹é‡åŒæ­¥ä½¿ç”¨è¯´æ˜.md`
