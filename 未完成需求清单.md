# 未完成需求清单

**更新时间**: 2025-10-15 01:59  
**当前完成度**: 89%

---

## 🟡 中优先级 (建议本周完成)

### 1. 历史记录前端页面 ⏱️ 3-4 小时
**状态**: 后端已完成，前端待开发

**需要做的**:
- [ ] 创建 `frontend/app/history/page.tsx`
- [ ] 实现任务列表组件
- [ ] 添加日期筛选
- [ ] 点击查看详情

**参考代码**:
```typescript
// frontend/app/history/page.tsx
'use client';

import { useState, useEffect } from 'react';
import { apiClient } from '@/lib/api-client';

export default function HistoryPage() {
  const [tasks, setTasks] = useState([]);
  
  useEffect(() => {
    apiClient.listScreenings(20).then(setTasks);
  }, []);
  
  return (
    <div className="container mx-auto p-8">
      <h1 className="text-3xl font-bold mb-6">历史记录</h1>
      <div className="space-y-4">
        {tasks.map(task => (
          <TaskCard key={task.task_id} task={task} />
        ))}
      </div>
    </div>
  );
}
```

---

### 2. 股票详情页 ⏱️ 3-4 小时
**状态**: K线组件已完成，需要创建详情页

**需要做的**:
- [ ] 创建 `frontend/app/stock/[code]/page.tsx`
- [ ] 集成 StockChart 组件
- [ ] 添加更多技术指标
- [ ] 添加基本面信息

**参考代码**:
```typescript
// frontend/app/stock/[code]/page.tsx
'use client';

import StockChart from '@/components/StockChart';

export default function StockDetailPage({ params }: { params: { code: string } }) {
  return (
    <div className="container mx-auto p-8">
      <h1 className="text-3xl font-bold mb-6">股票详情</h1>
      
      {/* K线图 */}
      <StockChart 
        stockCode={params.code} 
        stockName="股票名称" 
        days={60} 
      />
      
      {/* 技术指标 */}
      <div className="mt-8">
        <h2 className="text-2xl font-semibold mb-4">技术指标</h2>
        {/* MACD, RSI, BOLL 等 */}
      </div>
    </div>
  );
}
```

---

### 3. 卡片式布局优化 ⏱️ 2-3 小时
**状态**: 当前是表格，PRD 要求卡片式

**需要做的**:
- [ ] 修改 `frontend/app/page.tsx` 的结果展示部分
- [ ] 创建 StockCard 组件
- [ ] 响应式网格布局

**参考代码**:
```typescript
// frontend/components/StockCard.tsx
export default function StockCard({ stock }: { stock: StockResult }) {
  return (
    <div className="bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow">
      <div className="flex justify-between items-start mb-4">
        <div>
          <h3 className="text-xl font-bold">{stock.stock_name}</h3>
          <p className="text-gray-500">{stock.stock_code}</p>
        </div>
        <div className="text-right">
          <div className="text-2xl font-bold">¥{stock.close_price.toFixed(2)}</div>
          <div className={stock.change_pct > 0 ? 'text-red-600' : 'text-green-600'}>
            {stock.change_pct > 0 ? '+' : ''}{stock.change_pct.toFixed(2)}%
          </div>
        </div>
      </div>
      
      <div className="grid grid-cols-2 gap-4 mb-4">
        <div>
          <span className="text-gray-500">动量分数</span>
          <div className="text-lg font-semibold">{stock.momentum_score.toFixed(2)}</div>
        </div>
        <div>
          <span className="text-gray-500">综合评分</span>
          <div className="text-lg font-semibold">{stock.comprehensive_score.toFixed(2)}</div>
        </div>
      </div>
      
      <button 
        onClick={() => window.location.href = `/stock/${stock.stock_code}`}
        className="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700"
      >
        查看详情
      </button>
    </div>
  );
}

// 在 page.tsx 中使用
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
  {taskResult.results.map((stock) => (
    <StockCard key={stock.stock_code} stock={stock} />
  ))}
</div>
```

---

## 🟢 低优先级 (可选功能)

### 4. HTML 报告导出 ⏱️ 3-4 小时
**需要做的**:
- [ ] 创建 HTML 模板
- [ ] 添加导出 API
- [ ] 前端添加导出按钮

**参考代码**:
```python
# stockguru-web/backend/app/api/screening.py
from fastapi.responses import HTMLResponse
from jinja2 import Environment, FileSystemLoader

@router.get("/screening/{task_id}/export")
async def export_report(task_id: str):
    # 获取结果
    results = await screening_service.get_task_result(task_id)
    
    # 渲染模板
    env = Environment(loader=FileSystemLoader('templates'))
    template = env.get_template('report.html')
    html = template.render(results=results)
    
    return HTMLResponse(content=html)
```

---

### 5. 命令行工具 ⏱️ 2-3 小时
**需要做的**:
- [ ] 创建 `cli.py`
- [ ] 使用 Click 库
- [ ] 支持参数配置

**参考代码**:
```python
# cli.py
import click
from datetime import datetime

@click.group()
def cli():
    """StockGuru 命令行工具"""
    pass

@cli.command()
@click.option('--date', default=None, help='筛选日期 (YYYY-MM-DD)')
@click.option('--top-n', default=10, help='筛选数量')
def screen(date, top_n):
    """运行股票筛选"""
    if date is None:
        date = datetime.now().strftime('%Y-%m-%d')
    
    click.echo(f'开始筛选 {date} 的股票...')
    # 调用筛选逻辑
    
@cli.command()
def list():
    """查看历史记录"""
    click.echo('历史筛选记录:')
    # 列出历史记录

if __name__ == '__main__':
    cli()
```

---

### 6. 更多技术指标 ⏱️ 4-6 小时
**需要做的**:
- [ ] MACD 指标
- [ ] RSI 指标
- [ ] BOLL 布林带
- [ ] 成交量柱状图

**参考代码**:
```python
# stockguru-web/backend/app/services/modules/technical_indicators.py
class TechnicalIndicators:
    @staticmethod
    def calculate_macd(prices, fast=12, slow=26, signal=9):
        """计算 MACD"""
        pass
    
    @staticmethod
    def calculate_rsi(prices, period=14):
        """计算 RSI"""
        pass
    
    @staticmethod
    def calculate_boll(prices, period=20, std=2):
        """计算布林带"""
        pass
```

---

## 📋 快速行动清单

### 今天可以完成 (2-3 小时)
- [ ] 卡片式布局优化

### 本周可以完成 (6-8 小时)
- [ ] 历史记录页面
- [ ] 股票详情页

### 下周可以完成 (5-7 小时)
- [ ] HTML 报告导出
- [ ] 命令行工具

---

## 🎯 完成后的效果

完成以上所有功能后:
- ✅ 完成度将达到 **100%**
- ✅ 所有 PRD 需求全部实现
- ✅ 用户体验大幅提升
- ✅ 功能完整的产品

---

## 📊 工作量估算

| 任务 | 优先级 | 工作量 | 依赖 |
|------|--------|--------|------|
| 历史记录页面 | 🟡 中 | 3-4h | 无 |
| 股票详情页 | 🟡 中 | 3-4h | 无 |
| 卡片式布局 | 🟡 中 | 2-3h | 无 |
| HTML 导出 | 🟢 低 | 3-4h | 无 |
| CLI 工具 | 🟢 低 | 2-3h | 无 |
| 技术指标 | 🟢 低 | 4-6h | 无 |
| **总计** | - | **17-24h** | - |

---

**建议**: 优先完成中优先级任务 (8-11 小时)，即可达到 95% 完成度

---

*最后更新: 2025-10-15 01:59*
